<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î©òÎç∏Î†àÏòàÌîÑ Îã§Ïù¥Ïä§ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #1a202c;
            --bg-card: #2d3748;
            --bg-board: #0e1218;
            --border-color: #4a5568;
            --text-primary: #e2e8f0;
            --text-secondary: #a0aec0;
            --accent-cyan: #2dd4bf;
            --accent-amber: #fbbF24;
            --group-alkali-metal: #fca5a5;
            --group-alkaline-earth-metal: #fdba74;
            --group-lanthanide: #fde68a;
            --group-actinide: #d9f99d;
            --group-transition-metal: #a5f3fc;
            --group-post-transition-metal: #a7f3d0;
            --group-metalloid: #bfdbfe;
            --group-other-nonmetal: #c7d2fe;
            --group-halogen: #e9d5ff;
            --group-noble-gas: #fbcfe8;
            --group-unknown: #9ca3af;
        }
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-primary);
            overflow-x: hidden;
        }
        .periodic-table-grid {
            display: grid;
            grid-template-columns: repeat(18, minmax(0, 1fr));
            gap: 4px;
        }
        .element-cell {
            aspect-ratio: 1 / 1;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 2px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.2s ease-in-out;
            position: relative;
            cursor: default;
            color: #1a202c;
        }
        .element-cell.group-alkali-metal { background-color: var(--group-alkali-metal); }
        .element-cell.group-alkaline-earth-metal { background-color: var(--group-alkaline-earth-metal); }
        .element-cell.group-lanthanide { background-color: var(--group-lanthanide); }
        .element-cell.group-actinide { background-color: var(--group-actinide); }
        .element-cell.group-transition-metal { background-color: var(--group-transition-metal); }
        .element-cell.group-post-transition-metal { background-color: var(--group-post-transition-metal); }
        .element-cell.group-metalloid { background-color: var(--group-metalloid); }
        .element-cell.group-other-nonmetal { background-color: var(--group-other-nonmetal); }
        .element-cell.group-halogen { background-color: var(--group-halogen); }
        .element-cell.group-noble-gas { background-color: var(--group-noble-gas); }
        .element-cell.group-unknown { background-color: var(--group-unknown); }
        
        .element-cell:hover {
            transform: scale(1.1);
            z-index: 10;
        }
        .element-cell.producible {
            outline: 2px solid var(--accent-amber);
            box-shadow: 0 0 10px var(--accent-amber);
        }
        .element-cell.explosion-choice, .element-cell.slide-choice {
            cursor: pointer;
            outline: 2px solid var(--accent-cyan);
            box-shadow: 0 0 10px var(--accent-cyan);
        }
        .element-cell.slide-source {
            cursor: pointer;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 5px var(--accent-amber); }
            50% { box-shadow: 0 0 15px var(--accent-amber); }
        }

        .element-number { font-size: 0.6rem; }
        .element-symbol { font-size: 0.9rem; font-weight: 700; text-align: center; }
        .element-name { font-size: 0.5rem; text-align: center; color: #4a5568; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        .cube-container {
            position: absolute;
            bottom: 2px;
            right: 2px;
            display: flex;
            gap: 2px;
        }
        .cube {
            width: 8px;
            height: 8px;
            border-radius: 2px;
            border: 1px solid rgba(0,0,0,0.7);
        }
        .cube-red { background-color: #ef4444; } .cube-blue { background-color: #3b82f6; }
        .cube-green { background-color: #22c55e; } .cube-yellow { background-color: #eab308; }
        .cube-purple { background-color: #a855f7; } .cube-pink { background-color: #ec4899; }

        .player-card.active {
            border-color: var(--accent-amber);
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.5);
        }
        
        .modal-backdrop {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.7); backdrop-filter: blur(4px);
            z-index: 40; display: flex; justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: var(--bg-card); border: 1px solid var(--border-color);
            padding: 2rem; border-radius: 0.5rem; max-width: 90vw; max-height: 90vh;
            overflow-y: auto; z-index: 50; color: var(--text-primary);
        }
        .modal-content select {
            color: black;
        }
        .tech-icon {
            display: inline-flex; align-items: center; justify-content: center;
            width: 24px; height: 24px; border-radius: 50%; font-weight: bold;
            color: white; margin-right: 4px;
        }
        .tech-multiply { background-color: #dc2626; } .tech-concat { background-color: #2563eb; }
        .tech-slide { background-color: #16a34a; } .tech-outsource { background-color: #f59e0b; }
        
        .btn {
            padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 700;
            transition: all 0.2s;
            background-image: linear-gradient(to top, rgba(0,0,0,0.2), transparent);
        }
        .btn-primary { background-color: var(--accent-cyan); color: var(--bg-dark); }
        .btn-primary:hover { background-color: #5eead4; }
        .btn-secondary { background-color: var(--border-color); color: var(--text-primary); }
        .btn-secondary:hover { background-color: #718096; }
        .btn:disabled { background-color: #4a5568; color: #718096; cursor: not-allowed; background-image: none; }
        .btn-sm { padding: 0.25rem 0.5rem; font-size: 0.875rem; }

        /* Scoreboard Styles */
        #scoreboard-track {
            display: grid;
            grid-template-columns: repeat(20, 1fr);
            gap: 2px;
            position: relative;
        }
        .score-cell {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            text-align: center;
            font-weight: 700;
            padding: 4px 0;
            position: relative;
        }
        .score-cell.dice-reward { color: var(--accent-amber); }
        .score-cell.tech-reward { background-color: #111827; color: white; }
        .score-cell.tech-reward.dice-reward { color: var(--accent-amber); }
        .player-token {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid white;
            transition: all 0.5s ease-in-out;
            z-index: 15;
        }
    </style>
</head>
<body class="bg-bg-dark text-text-primary">

    <div id="app" class="container mx-auto p-4 min-h-screen">
        
        <header class="text-center mb-4">
            <h1 class="text-4xl font-bold text-accent-cyan">üé≤ Î©òÎç∏Î†àÏòàÌîÑ Îã§Ïù¥Ïä§</h1>
            <p id="game-status" class="text-lg text-text-secondary mt-2">Í≤åÏûÑÏùÑ ÏãúÏûëÌï¥Ï£ºÏÑ∏Ïöî.</p>
        </header>

        <div id="scoreboard-panel" class="mb-4 p-3 bg-bg-board border border-border-color rounded-lg shadow-lg"></div>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <aside id="players-panel" class="lg:col-span-2 space-y-4"></aside>

            <div id="center-panel" class="lg:col-span-5">
                <div id="periodic-table-container" class="bg-bg-board p-3 rounded-lg shadow-lg"></div>
                <div id="controls-panel" class="mt-4 p-4 bg-bg-card border border-border-color rounded-lg shadow-lg text-center"></div>
                <div id="tech-track-panel" class="mt-4 p-4 bg-bg-card border border-border-color rounded-lg shadow-lg"></div>
            </div>

            <aside id="market-panel" class="lg:col-span-5 grid grid-cols-1 sm:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-xl font-bold text-accent-amber mb-2">Í∏∞Î≥∏ ÌôîÌï©Î¨º ÏãúÏû•</h3>
                    <div id="basic-market" class="grid grid-cols-1 gap-3"></div>
                </div>
                <div>
                    <h3 class="text-xl font-bold text-fuchsia-400 mb-2">Í≥†Í∏â ÌôîÌï©Î¨º ÏãúÏû•</h3>
                    <div id="advanced-market" class="grid grid-cols-1 gap-3"></div>
                </div>
            </aside>

        </main>
    </div>

    <div id="setup-modal" class="modal-backdrop">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4">Í≤åÏûÑ ÏÑ§Ï†ï</h2>
            <label class="block mb-2 text-text-secondary">ÌîåÎ†àÏù¥Ïñ¥ Ïàò:</label>
            <div id="player-count-selector" class="flex justify-center gap-2 mb-6"></div>
            <button id="start-game-btn" class="w-full btn btn-primary" disabled>Í≤åÏûÑ ÏãúÏûë!</button>
        </div>
    </div>

    <div id="calculation-modal" class="modal-backdrop hidden">
        <div class="modal-content w-full max-w-lg">
            <h2 class="text-2xl font-bold mb-4">‚öõÔ∏è ÏõêÏûêÎ≤àÌò∏ Í≥ÑÏÇ∞</h2>
            <div id="calc-player-name" class="font-bold mb-2 text-accent-cyan"></div>
            <p class="mb-4 text-text-secondary">Íµ¥Î¶∞ Ï£ºÏÇ¨ÏúÑ Îàà:</p>
            <div id="dice-roll-results" class="flex flex-wrap gap-2 mb-4"></div>
            <div class="space-y-4">
                <div>
                    <h3 class="font-bold">Î∞©Î≤ï 1: Ï£ºÏÇ¨ÏúÑ 1Í∞ú ÏÑ†ÌÉù</h3>
                    <div id="single-dice-options" class="flex flex-wrap gap-2 mt-2"></div>
                </div>
                <div>
                    <h3 class="font-bold">Î∞©Î≤ï 2: Ï£ºÏÇ¨ÏúÑ 2Í∞ú Ïó∞ÏÇ∞</h3>
                    <div class="flex items-center gap-2 flex-wrap bg-bg-dark p-3 rounded-md">
                        <select id="calc-dice-1" class="p-2 border border-border-color bg-white rounded"></select>
                        <select id="calc-op" class="p-2 border border-border-color bg-white rounded"></select>
                        <select id="calc-dice-2" class="p-2 border border-border-color bg-white rounded"></select>
                        <span class="font-bold text-lg text-text-secondary">=</span>
                        <span id="calc-result" class="font-bold text-lg w-12 text-center text-accent-amber">?</span>
                    </div>
                    <p id="calc-error" class="text-red-400 text-sm h-5 mt-1"></p>
                </div>
            </div>
            <div class="mt-6 flex justify-between items-center">
                <button id="view-market-calc-btn" class="btn btn-secondary">ÏãúÏû• Î≥¥Í∏∞</button>
                <button id="confirm-production-btn" class="btn btn-primary" disabled>Ïù¥ ÏõêÏÜåÎ°ú ÏÉùÏÇ∞</button>
            </div>
        </div>
    </div>
    
    <div id="choice-modal" class="modal-backdrop hidden">
        <div class="modal-content text-center">
            <h2 id="choice-title" class="text-xl font-bold mb-4"></h2>
            <div id="choice-options" class="flex flex-wrap justify-center gap-3"></div>
            <div class="mt-6">
                <button id="view-market-choice-btn" class="btn btn-secondary">ÏãúÏû• Î≥¥Í∏∞</button>
            </div>
        </div>
    </div>

    <div id="game-over-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <h2 class="text-3xl font-bold mb-4 text-center text-accent-amber">üèÜ Í≤åÏûÑ Ï¢ÖÎ£å! üèÜ</h2>
            <div id="final-scores" class="space-y-2 mb-4"></div>
            <hr class="border-border-color my-4">
            <div id="game-stats" class="text-sm"></div>
            <div class="text-center mt-6">
                <button onclick="location.reload()" class="btn btn-primary">ÏÉà Í≤åÏûÑ ÏãúÏûë</button>
            </div>
        </div>
    </div>
    
    <button id="toggle-dev-panel" class="fixed bottom-2 left-2 text-2xl bg-bg-card p-2 rounded-full shadow-lg z-30">üõ†Ô∏è</button>
    <div id="dev-panel" class="fixed bottom-14 left-2 bg-gray-900 p-3 border border-border-color rounded-lg text-xs space-y-2 z-30 hidden">
        <h4 class="font-bold text-center">Í∞úÎ∞úÏûê ÎèÑÍµ¨</h4>
        <div class="flex gap-1">
            <input type="number" id="dev-score-num" class="w-16 bg-bg-dark border border-border-color rounded p-1" placeholder="Ï†êÏàò" value="5">
            <button id="dev-add-score" class="btn btn-secondary btn-sm flex-grow">Ï†êÏàò+</button>
        </div>
        <button id="dev-add-die" class="btn btn-secondary btn-sm w-full">Ï£ºÏÇ¨ÏúÑ+</button>
        <button id="dev-add-tech" class="btn btn-secondary btn-sm w-full">Í∏∞Ïà†+</button>
        <div class="flex gap-1">
            <input type="number" id="dev-element-num" class="w-16 bg-bg-dark border border-border-color rounded p-1" placeholder="ÏõêÏûêÎ≤àÌò∏">
            <button id="dev-add-cube" class="btn btn-secondary btn-sm flex-grow">ÌÅêÎ∏å+</button>
        </div>
    </div>

    <button id="return-to-modal-btn" class="fixed bottom-4 left-1/2 -translate-x-1/2 btn btn-primary z-40 hidden">ÌåùÏóÖÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞</button>

<script>
// DATA
const periodicTableData = [null,{number:1,symbol:"H",name:"ÏàòÏÜå",group:"other-nonmetal"},{number:2,symbol:"He",name:"Ìó¨Î•®",group:"noble-gas"},{number:3,symbol:"Li",name:"Î¶¨Ìä¨",group:"alkali-metal"},{number:4,symbol:"Be",name:"Î≤†Î¶¥Î•®",group:"alkaline-earth-metal"},{number:5,symbol:"B",name:"Î∂ïÏÜå",group:"metalloid"},{number:6,symbol:"C",name:"ÌÉÑÏÜå",group:"other-nonmetal"},{number:7,symbol:"N",name:"ÏßàÏÜå",group:"other-nonmetal"},{number:8,symbol:"O",name:"ÏÇ∞ÏÜå",group:"other-nonmetal"},{number:9,symbol:"F",name:"ÌîåÎ£®Ïò§Î¶∞",group:"halogen"},{number:10,symbol:"Ne",name:"ÎÑ§Ïò®",group:"noble-gas"},{number:11,symbol:"Na",name:"ÎÇòÌä∏Î•®",group:"alkali-metal"},{number:12,symbol:"Mg",name:"ÎßàÍ∑∏ÎÑ§Ïäò",group:"alkaline-earth-metal"},{number:13,symbol:"Al",name:"ÏïåÎ£®ÎØ∏ÎäÑ",group:"post-transition-metal"},{number:14,symbol:"Si",name:"Í∑úÏÜå",group:"metalloid"},{number:15,symbol:"P",name:"Ïù∏",group:"other-nonmetal"},{number:16,symbol:"S",name:"Ìô©",group:"other-nonmetal"},{number:17,symbol:"Cl",name:"ÏóºÏÜå",group:"halogen"},{number:18,symbol:"Ar",name:"ÏïÑÎ•¥Í≥§",group:"noble-gas"},{number:19,symbol:"K",name:"ÏπºÎ•®",group:"alkali-metal"},{number:20,symbol:"Ca",name:"ÏπºÏäò",group:"alkaline-earth-metal"},{number:21,symbol:"Sc",name:"Ïä§Ïπ∏Îìê",group:"transition-metal"},{number:22,symbol:"Ti",name:"Ìã∞ÌÉÄÎäÑ",group:"transition-metal"},{number:23,symbol:"V",name:"Î∞îÎÇòÎìê",group:"transition-metal"},{number:24,symbol:"Cr",name:"ÌÅ¨Î°úÎÆ¥",group:"transition-metal"},{number:25,symbol:"Mn",name:"ÎßùÍ∞ÄÎãàÏ¶à",group:"transition-metal"},{number:26,symbol:"Fe",name:"Ï≤†",group:"transition-metal"},{number:27,symbol:"Co",name:"ÏΩîÎ∞úÌä∏",group:"transition-metal"},{number:28,symbol:"Ni",name:"ÎãàÏºà",group:"transition-metal"},{number:29,symbol:"Cu",name:"Íµ¨Î¶¨",group:"transition-metal"},{number:30,symbol:"Zn",name:"ÏïÑÏó∞",group:"transition-metal"},{number:31,symbol:"Ga",name:"Í∞àÎ•®",group:"post-transition-metal"},{number:32,symbol:"Ge",name:"Ï†ÄÎßàÎäÑ",group:"metalloid"},{number:33,symbol:"As",name:"ÎπÑÏÜå",group:"metalloid"},{number:34,symbol:"Se",name:"ÏÖÄÎ†àÎäÑ",group:"other-nonmetal"},{number:35,symbol:"Br",name:"Î∏åÎ°úÎØº",group:"halogen"},{number:36,symbol:"Kr",name:"ÌÅ¨Î¶ΩÌÜ§",group:"noble-gas"},{number:37,symbol:"Rb",name:"Î£®ÎπÑÎìê",group:"alkali-metal"},{number:38,symbol:"Sr",name:"Ïä§Ìä∏Î°†Ìä¨",group:"alkaline-earth-metal"},{number:39,symbol:"Y",name:"Ïù¥Ìä∏Î•®",group:"transition-metal"},{number:40,symbol:"Zr",name:"ÏßÄÎ•¥ÏΩîÎäÑ",group:"transition-metal"},{number:41,symbol:"Nb",name:"ÎÇòÏù¥Ïò§Î∏Ä",group:"transition-metal"},{number:42,symbol:"Mo",name:"Î™∞Î¶¨Î∏åÎç∞ÎÑò",group:"transition-metal"},{number:43,symbol:"Tc",name:"ÌÖåÌÅ¨ÎÑ§Ìä¨",group:"transition-metal"},{number:44,symbol:"Ru",name:"Î£®ÌÖåÎäÑ",group:"transition-metal"},{number:45,symbol:"Rh",name:"Î°úÎìê",group:"transition-metal"},{number:46,symbol:"Pd",name:"ÌåîÎùºÎìê",group:"transition-metal"},{number:47,symbol:"Ag",name:"ÏùÄ",group:"transition-metal"},{number:48,symbol:"Cd",name:"Ïπ¥ÎìúÎÆ¥",group:"transition-metal"},{number:49,symbol:"In",name:"Ïù∏Îìê",group:"post-transition-metal"},{number:50,symbol:"Sn",name:"Ï£ºÏÑù",group:"post-transition-metal"},{number:51,symbol:"Sb",name:"ÏïàÌã∞Î™®Îãà",group:"metalloid"},{number:52,symbol:"Te",name:"ÌÖîÎ£®Î•®",group:"metalloid"},{number:53,symbol:"I",name:"ÏïÑÏù¥Ïò§Îîò",group:"halogen"},{number:54,symbol:"Xe",name:"Ï†úÎÖº",group:"noble-gas"},{number:55,symbol:"Cs",name:"ÏÑ∏Ïäò",group:"alkali-metal"},{number:56,symbol:"Ba",name:"Î∞îÎ•®",group:"alkaline-earth-metal"},{number:57,symbol:"La",name:"ÎûÄÌÉÄÎÑò",group:"lanthanide"},{number:58,symbol:"Ce",name:"ÏÑ∏Î•®",group:"lanthanide"},{number:59,symbol:"Pr",name:"ÌîÑÎùºÏÑ∏Ïò§ÎîîÎÆ¥",group:"lanthanide"},{number:60,symbol:"Nd",name:"ÎÑ§Ïò§ÎîîÎÆ¥",group:"lanthanide"},{number:61,symbol:"Pm",name:"ÌîÑÎ°úÎ©îÌä¨",group:"lanthanide"},{number:62,symbol:"Sm",name:"ÏÇ¨ÎßàÎ•®",group:"lanthanide"},{number:63,symbol:"Eu",name:"Ïú†Î°úÌì∏",group:"lanthanide"},{number:64,symbol:"Gd",name:"Í∞ÄÎèåÎ¶¨ÎäÑ",group:"lanthanide"},{number:65,symbol:"Tb",name:"ÌÑ∞Î∏Ä",group:"lanthanide"},{number:66,symbol:"Dy",name:"ÎîîÏä§ÌîÑÎ°úÏäò",group:"lanthanide"},{number:67,symbol:"Ho",name:"ÌôÄÎÆ¥",group:"lanthanide"},{number:68,symbol:"Er",name:"Ïñ¥Î∏Ä",group:"lanthanide"},{number:69,symbol:"Tm",name:"Ìà¥Î•®",group:"lanthanide"},{number:70,symbol:"Yb",name:"Ïù¥ÌÑ∞Î∏Ä",group:"lanthanide"},{number:71,symbol:"Lu",name:"Î£®ÌÖåÌä¨",group:"lanthanide"},{number:72,symbol:"Hf",name:"ÌïòÌîÑÎäÑ",group:"transition-metal"},{number:73,symbol:"Ta",name:"ÌÉÑÌÉàÎüº",group:"transition-metal"},{number:74,symbol:"W",name:"ÌÖÖÏä§ÌÖê",group:"transition-metal"},{number:75,symbol:"Re",name:"Î†àÎäÑ",group:"transition-metal"},{number:76,symbol:"Os",name:"Ïò§Ïä§ÎÆ¥",group:"transition-metal"},{number:77,symbol:"Ir",name:"Ïù¥Î¶¨Îìê",group:"transition-metal"},{number:78,symbol:"Pt",name:"Î∞±Í∏à",group:"transition-metal"},{number:79,symbol:"Au",name:"Í∏à",group:"transition-metal"},{number:80,symbol:"Hg",name:"ÏàòÏùÄ",group:"transition-metal"},{number:81,symbol:"Tl",name:"ÌÉàÎ•®",group:"post-transition-metal"},{number:82,symbol:"Pb",name:"ÎÇ©",group:"post-transition-metal"},{number:83,symbol:"Bi",name:"ÎπÑÏä§Î¨¥Ìä∏",group:"post-transition-metal"},{number:84,symbol:"Po",name:"Ìè¥Î°úÎäÑ",group:"post-transition-metal"},{number:85,symbol:"At",name:"ÏïÑÏä§ÌÉÄÌã¥",group:"halogen"},{number:86,symbol:"Rn",name:"ÎùºÎèà",group:"noble-gas"},{number:87,symbol:"Fr",name:"ÌîÑÎûëÏäò",group:"alkali-metal"},{number:88,symbol:"Ra",name:"ÎùºÎìê",group:"alkaline-earth-metal"},{number:89,symbol:"Ac",name:"ÏïÖÌã∞ÎäÑ",group:"actinide"},{number:90,symbol:"Th",name:"ÌÜ†Î•®",group:"actinide"},{number:91,symbol:"Pa",name:"ÌîÑÎ°úÌä∏ÏïÖÌã∞ÎäÑ",group:"actinide"},{number:92,symbol:"U",name:"Ïö∞ÎùºÎäÑ",group:"actinide"},{number:93,symbol:"Np",name:"ÎÑµÌà¨ÎäÑ",group:"actinide"},{number:94,symbol:"Pu",name:"ÌîåÎ£®ÌÜ†ÎäÑ",group:"actinide"},{number:95,symbol:"Am",name:"ÏïÑÎ©îÎ¶¨Ïäò",group:"actinide"},{number:96,symbol:"Cm",name:"ÌÄ¥Î•®",group:"actinide"},{number:97,symbol:"Bk",name:"Î≤ÑÌÅ¥Î•®",group:"actinide"},{number:98,symbol:"Cf",name:"Ï∫òÎ¶¨Ìè¨ÎäÑ",group:"actinide"},{number:99,symbol:"Es",name:"ÏïÑÏù∏ÏäàÌÉÄÏù¥ÎäÑ",group:"actinide"},{number:100,symbol:"Fm",name:"ÌéòÎ•¥ÎÆ¥",group:"actinide"},{number:101,symbol:"Md",name:"Î©òÎç∏Î†àÎ∏Ä",group:"actinide"},{number:102,symbol:"No",name:"ÎÖ∏Î≤®Î•®",group:"actinide"},{number:103,symbol:"Lr",name:"Î°úÎ†åÏäò",group:"actinide"},{number:104,symbol:"Rf",name:"Îü¨ÎçîÌè¨Îìê",group:"transition-metal"},{number:105,symbol:"Db",name:"ÎçîÎ∏åÎäÑ",group:"transition-metal"},{number:106,symbol:"Sg",name:"ÏãúÎ≥¥Í∑¨",group:"transition-metal"},{number:107,symbol:"Bh",name:"Î≥¥Î•®",group:"transition-metal"},{number:108,symbol:"Hs",name:"ÌïòÏäò",group:"transition-metal"},{number:109,symbol:"Mt",name:"ÎßàÏù¥Ìä∏ÎÑàÎ•®",group:"unknown"},{number:110,symbol:"Ds",name:"Îã§Î¶ÑÏäàÌÉÄÌä¨",group:"unknown"},{number:111,symbol:"Rg",name:"Î¢¥Ìä∏Í≤åÎäÑ",group:"unknown"},{number:112,symbol:"Cn",name:"ÏΩîÌéòÎ•¥ÎãàÏäò",group:"transition-metal"},{number:113,symbol:"Nh",name:"ÎãàÌò∏ÎäÑ",group:"unknown"},{number:114,symbol:"Fl",name:"ÌîåÎ†àÎ°úÎ∏Ä",group:"post-transition-metal"},{number:115,symbol:"Mc",name:"Î™®Ïä§ÏΩîÎ∏Ä",group:"unknown"},{number:116,symbol:"Lv",name:"Î¶¨Î≤ÑÎ™®Î•®",group:"unknown"},{number:117,symbol:"Ts",name:"ÌÖåÎÑ§Ïã†",group:"halogen"},{number:118,symbol:"Og",name:"Ïò§Í∞ÄÎÑ§ÏÜê",group:"noble-gas"}];
const cardDataString = `3   ÏàòÏÜåÏó∞Î£åÏ†ÑÏßÄ  ÏùºÎ∞ò  ÏàòÏÜåÏôÄ ÏÇ∞ÏÜåÏôÄ Î∞òÏùëÌï¥ Î¨ºÍ≥º Ï†ÑÍ∏∞ÏóêÎÑàÏßÄÎ•º ÏÉùÏÇ∞Ìï©ÎãàÎã§.  1   H   ÏàòÏÜå  8   O   ÏÇ∞ÏÜå
3   Ïö∞Ï£ºÏùò Íµ¨ÏÑ±ÏõêÏÜå    ÏùºÎ∞ò  ÎπÖÎ±Ö ÎãπÏãú ÎßåÎì§Ïñ¥ÏßÑ ÏàòÏÜåÏôÄ Ìó¨Î•®ÏóêÏÑú ÏãúÏûëÌï¥ Ïö∞Ï£ºÏùò Ïó≠ÏÇ¨Î•º ÏßÄÎÇòÎ©∞ Î¨¥Í∂ÅÎ¨¥ÏßÑÌïòÍ≤å ÎßéÏùÄ ÏõêÏÜåÍ∞Ä ÎßåÎì§Ïñ¥Ï°åÎÑ§Ïöî.  1   H   ÏàòÏÜå  2   He  Ìó¨Î•®
1   Ìó¨Î•®Í∞ÄÏä§(ÌíçÏÑ†)    ÏùºÎ∞ò  Î∞ÄÎèÑÍ∞Ä ÎÇÆÏïÑ Ìù°ÏûÖÌïòÎ©¥ Î™©ÏÜåÎ¶¨Í∞Ä ÎÜíÏïÑÏßëÎãàÎã§.  2   He  Ìó¨Î•®
4   Î¶¨Ìä¨Î∞∞ÌÑ∞Î¶¨   ÏùºÎ∞ò  ÎèôÏ†ÑÏ≤òÎüº ÏÉùÍ∏¥ Ï†ÑÏßÄÍ∞Ä Î≥¥ÌÜµ Î¶¨Ìä¨ÏúºÎ°ú ÎßåÎì§Ïñ¥ÏßÑ Î∞∞ÌÑ∞Î¶¨ÏûÖÎãàÎã§.  3   Li  Î¶¨Ìä¨
5   Î∂ïÏÇ¨(Ïï°Ï≤¥Í¥¥Î¨º)    ÏùºÎ∞ò  Ïï°Ï≤¥Í¥¥Î¨ºÏùò ÎßêÎûë Ï´ÄÎìùÌïú ÎäêÎÇåÏùÄ Î∂ïÏÇ¨ ÎçïÎ∂ÑÏóê Í∑∏Î†áÍ≤å ÎêòÎäî Í≤ÉÏûÖÎãàÎã§.  1   H   ÏàòÏÜå  5   B   Î∂ïÏÜå  8   O   ÏÇ∞ÏÜå
3   Ï∫î   ÏùºÎ∞ò  Ïûò ÌåΩÏ∞ΩÌïòÍ≥†, Î™®ÏñëÎèÑ Ïû°Í∏∞ ÏâΩÍ≥†, Ïó¥Ï†ÑÎèÑÏú®ÎèÑ ÎÜíÏùÄÎç∞ ÏùåÎ£å Î≥¥Í¥ÄÏö© Ï∫îÏúºÎ°ú ÌôúÏö©ÌïòÏßÄ ÏïäÏùÑ Ïù¥Ïú†Í∞Ä ÏûàÏùÑÍπåÏöî?  13  Al  ÏïåÎ£®ÎØ∏ÎäÑ
3   Í∑∏ÎûòÌïÄ ÏùºÎ∞ò  Í∞ïÎèÑÍ∞Ä Îß§Ïö∞ Í∞ïÌïòÎ©∞, Ï∞®ÏÑ∏ÎåÄÏùò Î¨ºÏßàÎ°ú Í∞ÅÍ¥ëÎ∞õÍ≥† ÏûàÏäµÎãàÎã§.  6   C   ÌÉÑÏÜå
5   Ïù∏Ï≤¥Î•º Íµ¨ÏÑ±ÌïòÎäî ÎåÄÌëúÏõêÏÜå   ÏùºÎ∞ò  Ïú†Í∏∞ ÌôîÌïôÏóê ÏûÖÎ¨∏Ìï¥Î≥º ÏÉùÍ∞Å ÏûàÏúºÏã†Í∞ÄÏöî? Ï†ïÎßê Ïû¨ÎØ∏ÏûàÏäµÎãàÎã§!  1   H   ÏàòÏÜå  6   C   ÌÉÑÏÜå  8   O   ÏÇ∞ÏÜå
3   ÏïîÎ™®ÎãàÏïÑ    ÏùºÎ∞ò  ÏÉùÎ¨ºÏùÄ Îã®Î∞±ÏßàÏùÑ ÏÑ≠Ï∑® ÌõÑ ÎèÖÏÑ±Ïù¥ ÏûàÎäî ÏïîÎ™®ÎãàÏïÑÎ•º ÎèÖÏÑ±Ïù¥ Ï†ÅÏùÄ ÏöîÏÜåÎÇò ÏöîÏÜåÎ°ú ÎåÄÏÇ¨ÌïòÏó¨ Ï≤¥Ïô∏Î°ú Î∞∞ÏÑ§Ìï©ÎãàÎã§.  1   H   ÏàòÏÜå  7   N   ÏßàÏÜå
3   Î©îÌÖåÏù∏ ÏùºÎ∞ò  ÏÑ∏ÏÉÅÏóêÏÑú Í∞ÄÏû• Í∞ÑÎã®Ìïú ÌÉÑÏÜå ÌôîÌï©Î¨ºÎ°ú Ï≤úÏó∞ Í∞ÄÏä§Ïùò Ï£º ÏÑ±Î∂ÑÏù¥Í∏∞ÎèÑ Ìï©ÎãàÎã§.  1   H   ÏàòÏÜå  6   C   ÌÉÑÏÜå
4   Ï∂©ÏπòÏòàÎ∞© ÏπòÏïΩ ÏùºÎ∞ò  ÌîåÎ£®Ïò§Î¶∞Ìôî ÎÇòÌä∏Î•®ÏùÄ ÏπòÏïÑ ÌëúÎ©¥Ïùò ÏÑ∏Í∑†ÏùÑ ÏñµÏ†úÌïòÎäî Í∏∞Îä•Ïù¥ ÏûàÏñ¥ ÏπòÏïΩÏù¥ÎÇò Í∞ÄÍ∏ÄÏóê ÎßéÏù¥ ÏÇ¨Ïö©Îê©ÎãàÎã§.  9   F   ÌîåÎ£®Ïò§Î¶∞    11  Na  ÎÇòÌä∏Î•®
2   ÎÑ§Ïò®ÏÇ¨Ïù∏    ÏùºÎ∞ò  Í∏∞Î≥∏Ï†ÅÏúºÎ°ú ÎÑ§Ïò®ÏÇ¨Ïù∏ÏùÄ Ï£ºÌô©ÏÉâÏù¥ÏßÄÎßå, Îçî Îã§ÏñëÌïú ÏÉâÏùÑ ÎÇ¥Í≥† Ïã∂ÏùÑ Îïê Ïó¨Îü¨Í∞ÄÏßÄ Îã§Î•∏ Í∏∞Ï≤¥ÏôÄ ÌòºÌï©ÌïòÍ∏∞ÎèÑ Ìï©ÎãàÎã§.  10  Ne  ÎÑ§Ïò®
4   ÏÜåÍ∏à  ÏùºÎ∞ò  ÎÇòÌä∏Î•®ÏùÄ Ìè≠Î∞úÏÑ±ÏùÑ ÏßÄÎãàÍ≥†, ÏóºÏÜåÎäî Ïú†ÎèÖÍ∞ÄÏä§Ïù∏Îç∞ Ïñ¥Ïß∏ÏÑú Í∑∏ ÎëòÏùÑ Ìï©Ïπú ÏÜåÍ∏àÏùÄ ÏùåÏãùÏóê ÎÑ£ÏúºÎ©¥ ÎßõÏûàÏñ¥ÏßÄÎäîÍ±∏ÍπåÏöî?  11  Na  ÎÇòÌä∏Î•® 17  Cl  ÏóºÏÜå
3   ÏóºÏÇ∞  ÏùºÎ∞ò  ÍµêÍ≥ºÏÑú Ïã§ÌóòÏóêÏÑú Î≥¥Îçò ÎÖÄÏÑùÏùÄ Î¨ΩÏùÄ ÏóºÏÇ∞Ïù¥ÏßÄÎßå ÏõêÎûò ÏóºÏÇ∞ÏùÄ ÏóÑÏ≤≠ÎÇòÍ≤å Í∞ïÌïú Í∞ïÏÇ∞Ïù¥ÎùºÍµ¨Ïöî!  1   H   ÏàòÏÜå  17  Cl  ÏóºÏÜå
6   Îã®Î∞±Ïßà ÏùºÎ∞ò  Ïù∏Ï≤¥Î•º Íµ¨ÏÑ±ÌïòÎäî ÏÑ∏Ìè¨Ïùò Í±∞Ïùò Î™®Îì† Í∏∞Îä•ÏùÑ ÏàòÌñâÌï©ÎãàÎã§. Î©îÌã∞Ïò§ÎãåÏù¥ÎùºÎäî ÏïÑÎØ∏ÎÖ∏ÏÇ∞ÏùÑ Ìè¨Ìï®Ìïú Îã®Î∞±ÏßàÏùÄ Ìô©(S)ÏùÑ Í∞ÄÏßëÎãàÎã§.  1   H   ÏàòÏÜå  6   C   ÌÉÑÏÜå  7   N   ÏßàÏÜå  8   O   ÏÇ∞ÏÜå  16  S   Ìô©
9   ATP ÏùºÎ∞ò  ÏÉùÎ™ÖÏ≤¥Ïùò ÏÉùÎ™ÖÌôúÎèôÏóê ÌïÑÏöîÌïú ÏóêÎÑàÏßÄÏõê. ÏÉùÎ¨ºÏùò ÌÉÑÏÉùÍ≥º Ìï®Íªò ÏÉùÎ™ÖÏùò Ïó≠ÏÇ¨Î•º Ìï®ÍªòÌïú ÌôîÌï©Î¨º.  1   H   ÏàòÏÜå  6   C   ÌÉÑÏÜå  7   N   ÏßàÏÜå  8   O   ÏÇ∞ÏÜå  15  P   Ïù∏
7   ÎπÑÎ£å  ÏùºÎ∞ò  ÎπÑÎ£åÏùò 3ÎåÄ ÏõêÏÜåÏûÖÎãàÎã§. ÏïàÏ†ïÏ†ÅÏúºÎ°ú ÎπÑÎ£åÎ•º ÏÉùÏÇ∞ Í∞ÄÎä•Ìï¥ÏßÑ ÏãúÏ†êÎ∂ÄÌÑ∞ ÏÑ∏Í≥Ñ Ïù∏Íµ¨Í∞Ä Ìè≠Î∞úÏ†ÅÏúºÎ°ú Ï¶ùÍ∞ÄÌñàÏäµÎãàÎã§.  7   N   ÏßàÏÜå  15  P   Ïù∏   19  K   ÏπºÎ•®
6   Î∞îÎã§Ïùò ÏóºÎ•ò  ÏùºÎ∞ò  ÌïòÎã§ÌïòÎã§ Ïù¥Ï†ú Î∞îÎã∑Î¨ºÎèÑ ÎßåÎì§Ïñ¥ Îã¨ÎùºÍµ¨Ïöî??  11  Na  ÎÇòÌä∏Î•® 12  Mg  ÎßàÍ∑∏ÎÑ§Ïäò    16  S   Ìô©   17  Cl  ÏóºÏÜå
3   ÏÑ¨Í¥ëÌÉÑÏùò Í∏àÏÜç Ï∂©Ï†Ñ  ÏùºÎ∞ò  Î∞òÏùëÏÑ±Ïù¥ ÎÜíÏùÄ Í∏àÏÜçÏù¥ ÏàúÏãùÍ∞ÑÏóê ÏÇ∞ÌôîÎêòÎ©¥ Í∞ïÎ†•Ìïú ÏÑ¨Í¥ëÏù¥ Î∞úÏÉùÎê©ÎãàÎã§. Ïù¥Î•º Ïù¥Ïö©Ìï¥ ÏãúÍ∞ÅÏùÑ ÏùºÏãúÏ†ÅÏúºÎ°ú Ï†ïÏßÄÏãúÏºúÏöî.  12  Mg  ÎßàÍ∑∏ÎÑ§Ïäò    13  Al  ÏïåÎ£®ÎØ∏ÎäÑ
3   Î≥¥Ìò∏Ïö© Í∏∞Ï≤¥  ÏùºÎ∞ò  Ïñ¥Îñ§ Î¨ºÏ≤¥Î•º ÏÇ∞ÏÜåÎÇò Îã§Î•∏ Î∞òÏùëÏÑ±Ïù¥ ÏûàÎäî Í∏∞Ï≤¥Î°úÎ∂ÄÌÑ∞ Î≥¥Ìò∏Ìï† Îïå Î∞òÏùëÏÑ±Ïù¥ Îß§Ïö∞ Ï†ÅÏùÄ ÏïÑÎ•¥Í≥§ÏùÑ Ïù¥Ïö©ÌïòÍ∏∞ÎèÑ Ìï©ÎãàÎã§.  18  Ar  ÏïÑÎ•¥Í≥§
6   ÎåÄÍ∏∞  ÏùºÎ∞ò  Ïù∏Î•òÎèÑ Ïñ∏Ï††Í∞Ä Ïù∏Í≥µ ÎåÄÍ∏∞Î•º ÎßåÎì§Ïñ¥ Îã§Î•∏ ÌñâÏÑ±ÏùÑ ÌÖåÎùºÌè¨Î∞ç ÌïòÎäî ÎÇ†Ïù¥ Ïò§Í≤†Ï£†?  7   N   ÏßàÏÜå  8   O   ÏÇ∞ÏÜå  18  Ar  ÏïÑÎ•¥Í≥§
6   ÌôîÏïΩ  ÏùºÎ∞ò  Ï†ÅÏ†àÌïú Ïó∞Î£åÎßå Ï°¥Ïû¨ÌïúÎã§Î©¥, Ïó∞ÏÜåÏùò ÏÜçÎèÑÍ∞Ä Îß§Ïö∞ Îπ†Î•∏ ÏßàÏÇ∞ÏπºÎ•®ÏùÑ ÌôúÏö©Ìï¥ ÌôîÏïΩÏùÑ Ï†úÏûëÌï† Ïàò ÏûàÏäµÎãàÎã§.  7   N   ÏßàÏÜå  8   O   ÏÇ∞ÏÜå  19  K   ÏπºÎ•®
5   Ïù∏ÏÇ∞Í∏∞, Ïù∏ÏÇ∞Ïóº    ÏùºÎ∞ò  ÎºàÏôÄ ÏπòÏïÑÎ•º Íµ¨ÏÑ±ÌïòÍ∏∞ÎèÑ ÌïòÍ≥†, ÏùòÌïô Î∞è ÏÉùÎ¨ºÌïô Î∂ÑÏïºÏóêÏÑú ÌôúÎ∞úÌïòÍ≤å Ïó∞Íµ¨ Î™©Ï†ÅÏúºÎ°ú Ïù¥Ïö©Îê©ÎãàÎã§.  1   H   ÏàòÏÜå  8   O   ÏÇ∞ÏÜå  15  P   Ïù∏
4   Ïú†Î¶¨  ÏùºÎ∞ò  Îã§ÏñëÌïú Í±¥Ï∂ïÎ¨º, ÏÇ∞ÏóÖÏóê Ïù¥Ïö©ÎêòÎäî Ïú†Î¶¨Îäî Ïù¥ÏÇ∞ÌôîÍ∑úÏÜåÎ°ú Ï£ºÎ°ú Ï†úÏûëÌï©ÎãàÎã§.  8   O   ÏÇ∞ÏÜå  14  Si  Í∑úÏÜå
5   ÏóºÌôî ÏπºÏäò   ÏùºÎ∞ò  Î¨ºÏóê ÎÖπÏúºÎ©¥ Ïñ¥ÎäîÏ†êÏùÑ ÌÅ¨Í≤å ÎÇÆÏ∂∞Ï£ºÏñ¥ ÌùîÌûà Ï†úÏÑ§Ïö©ÏúºÎ°ú ÎßéÏù¥ ÏÇ¨Ïö©Îê©ÎãàÎã§.  17  Cl  ÏóºÏÜå  20  Ca  ÏπºÏäò
5   Ìô©ÏÇ∞  ÏùºÎ∞ò  ÎåÄÌëúÏ†ÅÏù∏ Í∞ïÏÇ∞ÏúºÎ°ú Í∞Å ÎÇòÎùºÏùò Ìô©ÏÇ∞ ÏÉùÏÇ∞ÎüâÏù¥ Í∑∏ ÎÇòÎùºÏùò ÌôîÌïô ÏÇ∞ÏóÖ Í∑úÎ™®Î•º ÎÇòÌÉÄÎÇ¥Í∏∞ÎèÑ Ìï©ÎãàÎã§.  1   H   ÏàòÏÜå  8   O   ÏÇ∞ÏÜå  16  S   Ìô©
7   ÎùΩÏä§  ÏùºÎ∞ò  Ï∞®ÏïÑÏóºÏÜåÏÇ∞ÎÇòÌä∏Î•®ÏùÑ Î¨ºÏóê ÎÖπÏù∏ ÏàòÏö©Ïï°ÏùÑ ÎúªÌï©ÎãàÎã§. Ï£ºÎ∞©, ÏöïÏã§, ÏàòÏòÅÏû• Îì± Í∞ÄÏû• ÎßéÏù¥ Ïì∞Ïù¥Îäî ÏÇ¥Í∑†ÏÜåÎèÖÏö© Î¨ºÏßàÏù¥Í∏∞ÎèÑ Ìï©ÎãàÎã§.  8   O   ÏÇ∞ÏÜå  11  Na  ÎÇòÌä∏Î•® 17  Cl  ÏóºÏÜå
2   Îºà   ÏùºÎ∞ò  ÎºàÎ•º Íµ¨ÏÑ±ÌïòÎäî ÏõêÏÜåÏó¨ÏÑú ÏÑ≠Ï∑®Í∞Ä Ï§ëÏöîÌïòÎã§Í≥† Ïó¨Í≤®ÏßÄÏßÄÎßå Ïã†Í≤Ω Î∞è Í∑ºÏú° Î∞òÏùëÏóêÎèÑ ÏòÅÌñ•ÏùÑ ÎØ∏ÏπòÎäî Ï§ëÏöîÌïú ÏõêÏÜåÏûÖÎãàÎã§.  20  Ca  ÏπºÏäò
6   Î∂ÑÌïÑÍ≥º Ï°∞Í∞úÍªçÏßà    ÏùºÎ∞ò  ÌÉÑÏÇ∞ÏπºÏäòÏùÄ ÎåÄÎ¶¨ÏÑù, Îã¨Í±Ä, Ï°∞Í∞úÍªçÏßàÏùò ÏÑ±Î∂ÑÏûÖÎãàÎã§. ÏÇ∞ÏÑ± Î¨ºÏßàÍ≥º ÎßåÎÇòÎ©¥ Í±∞ÌíàÏùÑ ÎÇ¥Î©∞ Î∞òÏùëÌï©ÎãàÎã§.  6   C   ÌÉÑÏÜå  8   O   ÏÇ∞ÏÜå  20  Ca  ÏπºÏäò
8   ÏóêÎ©îÎûÑÎìú    ÏùºÎ∞ò  Í¥ëÎ¨ºÍ≥º Î≥¥ÏÑùÎì§ÎèÑ Îã§ÏñëÌïú ÏõêÏÜåÎ°ú Ïù¥Î£®Ïñ¥Ï†∏ÏûàÎã§Îäî ÏÇ¨Ïã§!  4   Be  Î≤†Î¶¥Î•® 8   O   ÏÇ∞ÏÜå  13  Al  ÏïåÎ£®ÎØ∏ÎäÑ    14  Si  Í∑úÏÜå
4   ÏßàÏÜåÏàúÌôòÌö®ÏÜåÏùò Î≥¥Ï°∞Ïù∏Ïûê    Í≥†Í∏â  ÏÉùÏ≤¥ Í∏∞Îä•ÏùÑ ÏàòÌñâÌïòÍ∏∞ ÏúÑÌïú Ìö®ÏÜåÏóê Ìè¨Ìï®Îêú ÌïÑÏàòÏ†ÅÏù∏ ÏõêÏÜåÏûÖÎãàÎã§. ÏãùÎ¨ºÏùò ÏßàÏÜåÍ≥†Ï†ï ÏûëÏö©Í≥º Ïó∞Í¥ÄÎêú Ìö®ÏÜåÏùò Î≥¥Ï°∞Ïù∏ÏûêÎ°ú ÏûëÏö©Ìï©ÎãàÎã§.  42  Mo  Î™∞Î¶¨Î∏åÎç∞ÎÑò
3   ÎèôÏÉÅ  Í≥†Í∏â  ÎûúÎìúÎßàÌÅ¨, Ïö∞ÏÉÅÌôî, ÏúÑÏù∏ Îì± Í∏∞ÎÖêÏÑ±Ïù¥ ÌïÑÏöîÌïú Îç∞ÏóêÎäî ÎèôÏÉÅÏù¥Ï£†. Î∂ÅÌïúÏù¥ ÎèôÏÉÅÍ∏∞Ïà† Í∞ïÍµ≠Ïù¥Í∏∞ÎèÑ Ìï©ÎãàÎã§.  29  Cu  Íµ¨Î¶¨
4   ÏïºÍ¥ë Î¨ºÏßà   Í≥†Í∏â  ÏïºÍ¥ë ÏÑ±ÏßàÏùÑ ÎÇòÌÉÄÎÇ¥Îäî Ïä§Ìä∏Î°†Ìä¨ ÌôîÌï©Î¨ºÏùÄ ÎπõÏùÑ Î∞õÏïÑ Ï¥âÍ¥ë ÏÉÅÌÉúÍ∞Ä ÎêòÎ©¥, Ïñ¥ÎëêÏõåÏßÄÎçîÎùºÎèÑ Ìù¨ÎØ∏ÌïòÍ≤å ÎπõÏùÑ ÎÇ¥ÎøúÎã§ Ïñ¥ÎëêÏõåÏßëÎãàÎã§.  38  Sr  Ïä§Ìä∏Î°†Ìä¨
3   Í≤åÎ•¥ÎßàÎäÑ ÌåîÏ∞å Í≥†Í∏â  Í≥ºÌïôÏùÑ Î∞∞Ïö¥ ÏπúÍµ¨Îì§Ïù¥ÎùºÎ©¥ ÏÇ¨Í∏∞ÎûÄ Í±∞ ÏïåÏ£†??  32  Ge  Ï†ÄÎßàÎäÑ
3   Ï†ÑÍµ¨Ïùò ÌïÑÎùºÎ©òÌä∏    Í≥†Í∏â  Ï†ÑÍ∏∞Ï†ÄÌï≠ÎèÑ Ïª§ÏÑú Î∞ùÏùÄ ÎπõÏùÑ ÎÇº ÏàòÎèÑ ÏûàÍ≥†, ÎÖπÎäî Ïò®ÎèÑÎèÑ ÎÜíÏúºÎãà Ï†ÑÍµ¨Ïóê ÌïÑÎùºÎ©òÌä∏Î°ú Ï†úÍ≤©Ïù¥Ï£†.  74  W   ÌÖÖÏä§ÌÖê
4   ÎùºÎèàÏùÑ Ìè¨ÏßëÌï¥Ï£ºÏÑ∏Ïöî  Í≥†Í∏â  ÏßÄÍµ¨ÏÉÅ Ïñ¥ÎîîÏóêÎÇò Ï°¥Ïû¨ÌïòÎäî ÏûêÏó∞ Î∞©ÏÇ¨ÏÑ± Î¨ºÏßàÏûÖÎãàÎã§. ÏÉàÏßëÏ¶ùÌõÑÍµ∞Í≥ºÎèÑ Ïó∞Í¥Ä ÏûàÏñ¥ ÎÖ∏Ï∂úÎêòÎ©¥ ÌèêÏïîÏùÑ Ïú†Î∞úÌï† Ïàò ÏûàÏäµÎãàÎã§.  86  Rn  ÎùºÎèà
3   Í≥†Í∏â ÏïàÍ≤ΩÌÖå  Í≥†Í∏â  ÎÇ¥ÏãùÏÑ±Ïù¥ Ïö∞ÏàòÌï¥ Î∂ÄÏãùÏù¥ Ïûò ÎêòÏßÄ ÏïäÏúºÎ©∞ Í∞ïÌïú Ï∂©Í≤©ÏóêÎèÑ Ïûò Î∂ÄÎü¨ÏßÄÏßÄ ÏïäÏïÑ ÏïàÍ≤ΩÌÖåÎ°ú ÌôúÏö©Îê©ÎãàÎã§.  22  Ti  Ìã∞ÌÉÄÎäÑ
5   Ïö∞Ï£º Í±∞Ïö∏   Í≥†Í∏â  Î≤†Î¶¥Î•®ÏùÄ Í∞ÄÎ≥çÍ≥† Ïó¥ÌåΩÏ∞ΩÎ•†Ïù¥ ÎÇÆÏïÑ Ïö∞Ï£ºÎ°ú Î∞úÏÇ¨ÎêòÎäî Î∞òÏÇ¨ ÎßùÏõêÍ≤Ω Í±∞Ïö∏Ïóê ÌôúÏö©Îê©ÎãàÎã§. Ï†úÏûÑÏä§ÏõπÏùÄ Ïó¨Í∏∞Ïóê Í∏à ÎèÑÍ∏àÏù¥ ÎêòÏóàÏ£†.  4   Be  Î≤†Î¶¥Î•® 79  Au  Í∏à
5   Í∞ÄÎ≤ºÏö¥ Ìï©Í∏à  Í≥†Í∏â  Ïä§Ïπ∏Îìê-ÏïåÎ£®ÎØ∏ÎäÑ Ìï©Í∏àÏùÄ Í∞ÄÎ≥çÍ≥† Í∞ïÎèÑÏôÄ ÎÇ¥Íµ¨ÏÑ±Ïù¥ Ï¢ãÏïÑ Ìï≠Í≥µÍ∏∞ Î∂ÄÌíàÏù¥ÎÇò ÏûêÏ†ÑÍ±∞ ÌîÑÎ†àÏûÑÏúºÎ°ú ÎßéÏù¥ ÌôúÏö©Îê©ÎãàÎã§.  13  Al  ÏïåÎ£®ÎØ∏ÎäÑ    21  Sc  Ïä§Ïπ∏Îìê
6   Í≥†ÏÑ±Îä• Ï°∞Î™ÖÍ∏∞Ï≤¥    Í≥†Í∏â  Ïπ¥Î©îÎùº ÌîåÎûòÏãúÎÇò Îì±ÎåÄÏùò Î∂àÎπõÏóê ÎßéÏù¥ ÏÇ¨Ïö©ÎêòÎäî Ïù¥Îì§ Í∏∞Ï≤¥Îäî Î∞òÏùëÏÑ±Ïù¥ Í±∞Ïùò ÏóÜÏñ¥ Ï°∞Î™ÖÏùò Ï∂©Ï†ÑÏû¨Î°ú ÌôúÏö©Îê©ÎãàÎã§.  36  Kr  ÌÅ¨Î¶ΩÌÜ§ 54  Xe  Ï†úÎÖº
4   ÏàòÏ†ïÌÖåÏù¥ÌîÑ, Ìù∞ Î¨ºÍ∞ê Í≥†Í∏â  Ïù¥ÏÇ∞ÌôîÌã∞ÌÉÄÎäÑÏùÄ Ìù∞ÏÉâÏùò ÌôîÌï©Î¨ºÎ°ú ÌéòÏù∏Ìä∏, ÏàòÏ†ïÌÖåÏù¥ÌîÑ Î∞è ÏÑ†ÌÅ¨Î¶ºÏóê Ï¢ÖÏ¢Ö Ïù¥Ïö©Îê©ÎãàÎã§.  8   O   ÏÇ∞ÏÜå  22  Ti  Ìã∞ÌÉÄÎäÑ
5   Ïã§Ïò®ÏóêÏÑú Ïï°Ï≤¥Ïù∏ Î¨ºÏßà Í≥†Í∏â  ÏàòÏùÄÏùÄ Ïò®ÎèÑÍ≥ÑÎ°úÎèÑ Ïù¥Ïö©ÎêòÏßÄÏöî? Ï£ºÍ∏∞Ïú®Ìëú ÏÉÅÏóêÏÑú ÍΩ§ Îñ®Ïñ¥ÏßÑ Îëê ÏõêÏÜåÍ∞Ä ÎπÑÏä∑Ìïú ÏÑ±ÏßàÏùÑ Í∞ñÍ≥† ÏûàÎã§Îãà Ïã†Í∏∞ÌïòÏßÄ ÏïäÎÇòÏöî?  35  Br  Î∏åÎ°úÎØº 80  Hg  ÏàòÏùÄ
5   ÎÖ∏ÎûÄÏÉâ Î¨ºÍ∞ê  Í≥†Í∏â  Îëê ÏõêÏÜåÎäî ÎÖ∏ÎûÄÏÉâÏùÑ ÎÇ¥Îäî Îç∞ ÏÇ¨Ïö©ÌïòÎäî ÎåÄÌëúÏ†ÅÏù∏ ÏóºÎ£åÏûÖÎãàÎã§.  24  Cr  ÌÅ¨Î°úÎÆ¥ 48  Cd  Ïπ¥ÎìúÎÆ¥
5   ÎÑà Í∑ÄÏó¨Ïõå   Í≥†Í∏â  Í≥ºÌïôÏùÑ Ï¢ãÏïÑÌïòÎäî Ïù¥ÏÑ±ÏπúÍµ¨Î•º ÎßåÎÇòÍ≥† Ïã∂Îã§Í≥†Ïöî? ÎÑå Íµ¨Î¶¨ÏôÄ ÌÖîÎ£®Î•®ÏúºÎ°ú Íµ¨ÏÑ±Îêú Í≤É Í∞ôÏïÑ!ÎùºÍ≥† ÌîåÎü¨ÌåÖ Ìï¥Î≥¥ÏÑ∏Ïöî!  29  Cu  Íµ¨Î¶¨  52  Te  ÌÖîÎ£®Î•®
6   Í±¥Ï†ÑÏßÄ Í≥†Í∏â  ÎßùÍ∞ÄÎãàÏ¶à Í±¥Ï†ÑÏßÄÎäî ÏùºÏ∞® Ï†ÑÏßÄ Ï§ë ÌïòÎÇòÎ°ú, Ï†ÑÌï¥Ïßà ÏÜçÏóêÏÑú ÏïÑÏó∞Í≥º Ïù¥ÏÇ∞Ìôî ÎßùÍ∞ÄÎãàÏ¶à Í∞ÑÏùò Ï†ÑÍ∏∞ÌôîÌïô Î∞òÏùëÏúºÎ°ú ÏóêÎÑàÏßÄÎ•º Í≥µÍ∏âÌï©ÎãàÎã§.  25  Mn  ÎßùÍ∞ÄÎãàÏ¶à    30  Zn  ÏïÑÏó∞
5   Í¥ëÏÑ¨Ïú† Í≥†Í∏â  Ìïú Î≤à ÏÑ¨Ïú† ÎÇ¥Î°ú Îì§Ïñ¥Í∞Ñ ÎπõÏù¥ ÎÇ¥Î∂ÄÏóêÏÑú Ï†ÑÎ∞òÏÇ¨Î•º ÌÜµÌï¥ Î∞òÎåÄÌé∏ÏúºÎ°ú ÎÇòÍ∞ëÎãàÎã§. Îç∞Ïù¥ÌÑ∞ ÏÜêÏã§Ïù¥ Ï†ÅÏñ¥ ÌÜµÏã†Ïóê ÌôúÏö©Îê©ÎãàÎã§.  14  Si  Í∑úÏÜå  32  Ge  Ï†ÄÎßàÎäÑ
5   ÎπÑÎìê ÏÉ¥Ìë∏   Í≥†Í∏â  Ìô©ÌôîÏÖÄÎ†àÎäÑÏùÄ ÎØ∏ÏÉùÎ¨ºÏóê ÏùòÌïú ÌîºÎ∂ÄÏóº¬∑ÎπÑÎì¨ÏùÑ ÏπòÎ£åÌïòÎäî ÏÉ¥Ìë∏ Îì±Ïóê ÏÇ¨Ïö©Îê©ÎãàÎã§.  16  S   Ìô©   34  Se  ÏÖÄÎ†àÎäÑ
6   Î∏åÎ°úÎßàÏù¥Îìú   Í≥†Í∏â  Î∏åÎ°úÎØºÌôîÏùÄ(AgBr)ÏùÑ ÏÇ¨Ïö©Ìïú Ïù∏ÌôîÏßÄÎ°ú Ïù∏ÏáÑÌïú ÏÇ¨ÏßÑÏùÑ ÏßÄÏπ≠Ìï©ÎãàÎã§. ÏµúÍ∑ºÏóêÎäî Ïó∞ÏòàÏù∏ ÎçïÏßàÏö© ÏÇ¨ÏßÑÏùÑ ÎúªÌïòÍ∏∞ÎèÑ ÌïòÏ£†.  35  Br  Î∏åÎ°úÎØº 47  Ag  ÏùÄ
6   Ïù∏Í≥µÏπòÏïÑ    Í≥†Í∏â  ÏûÑÌîåÎûÄÌä∏(ÌÅ¨ÎùºÏö¥)Ïóê Ïì∞Ïù¥Îäî Ïù∏Í≥µÏπòÏïÑ Ïû¨Î£å ÏõêÏÜåÎì§ÏûÖÎãàÎã§.  40  Zr  ÏßÄÎ•¥ÏΩîÎäÑ    79  Au  Í∏à
7   ÎßåÎÖÑÌïÑ ÌéúÏ¥â  Í≥†Í∏â  Í≥†Í∏â ÎßåÎÖÑÌïÑÏóê ÌôúÏö©ÎêòÎäî Í∏àÏÜç ÏõêÏÜåÎì§ÏûÖÎãàÎã§. Ïò§Îûú Í∏∞Í∞Ñ ÏÇ¨Ïö©Ìï¥ÎèÑ ÌïÑÍ∏∞Í∞êÏù¥ Î≥ÄÌïòÏßÄ ÏïäÎäîÎã§Í≥† Ìï©ÎãàÎã§.  44  Ru  Î£®ÌÖåÎäÑ 76  Os  Ïò§Ïä§Î∏Ä
5   ÎÇ©Îïú  Í≥†Í∏â  Îëê Í∞ú Ïù¥ÏÉÅÏùò Î¨ºÏßàÏùÑ Í≤∞Ìï©ÌïòÎäî Í∏∞Ï¥àÏ†ÅÏù∏ Ïö©Ï†ëÎ≤ïÏúºÎ°ú, Ïù∏Î•òÏùò Ïó≠ÏÇ¨ÏôÄ Ìï®ÍªòÌï¥Ïò® Í∏∞Ïà†ÏûÖÎãàÎã§.  50  Sn  Ï£ºÏÑù  82  Pb  ÎÇ©
5   ÏÉÅÎ≥ÄÌôî Î©îÎ™®Î¶¨ Í≥†Í∏â  ÎπÑÌúòÎ∞úÏÑ±Í≥º Îπ†Î•∏ ÏÜçÎèÑÏùò Ïû•Ï†êÏùÑ Í∞ÄÏßÑ Ï∞®ÏÑ∏ÎåÄ Î©îÎ™®Î¶¨ Î∞òÎèÑÏ≤¥ÏûÖÎãàÎã§.  51  Sb  ÏïàÌã∞Î™®Îãà    52  Te  ÌÖîÎ£®Î•®
4   ÏïÑÏù¥Ïò§ÎîòÌôî ÏπºÎ•®    Í≥†Í∏â  ÎÖπÎßêÍ≥º Î∞òÏùëÌïòÎ©¥ Ï≤≠ÎûåÏÉâÏúºÎ°ú Î≥ÄÌï¥ ÏòÅÏñëÏÜå Í≤ÄÏ∂ú Ïã§ÌóòÏóê ÏûêÏ£º ÏÇ¨Ïö©Îê©ÎãàÎã§.  19  K   ÏπºÎ•®  53  I   ÏïÑÏù¥Ïò§Îîò
5   ÎßéÏù¥ Ïù¥Ïö©ÎêòÎäî Í∏àÏÜçÏõêÏÜå    Í≥†Í∏â  ÎπÑÎ£åÏùò 3ÎåÄ ÏõêÏÜåÎ°ú, ÏïàÏ†ïÏ†Å ÎπÑÎ£å ÏÉùÏÇ∞Ïù¥ Í∞ÄÎä•Ìï¥ÏßÑ Ïù¥ÌõÑ ÏÑ∏Í≥Ñ Ïù∏Íµ¨Í∞Ä Ìè≠Î∞úÏ†ÅÏúºÎ°ú Ï¶ùÍ∞ÄÌñàÏäµÎãàÎã§.  12  Mg  ÎßàÍ∑∏ÎÑ§Ïäò    13  Al  ÏïåÎ£®ÎØ∏ÎäÑ    26  Fe  Ï≤†
8   Î∞òÎèÑÏ≤¥Ïóê Ïù¥Ïö©ÎêòÎäî ÏõêÏÜå    Í≥†Í∏â  Î¨ºÎ¶¨Ìïô Ïó≠ÏÇ¨ÏÉÅ Í∞ÄÏû• Ïã§Ïö©Ï†ÅÏù¥Î©∞, ÌòÑÎåÄ Ï†ïÎ≥¥ ÏÇ∞ÏóÖÏùò Í∏∞Ï¥àÍ∞Ä Îêú Î¨ºÏ≤¥Îì§ÏûÖÎãàÎã§.  14  Si  Í∑úÏÜå  32  Ge  Ï†ÄÎßàÎäÑ 51  Sb  ÏïàÌã∞Î™®Îãà
8   Î∂àÍΩÉÎÜÄÏù¥    Í≥†Í∏â  Ìè≠Î∞úÏùÄ ÏòàÏà†Ïù¥Ï£†. Ïù¥ Ïô∏ÏóêÎèÑ Îã§ÏñëÌïú ÏõêÏÜåÎì§Ïù¥ ÌôúÏö©Îê©ÎãàÎã§.  22  Ti  Ìã∞ÌÉÄÎäÑ 38  Sr  Ïä§Ìä∏Î°†Ìä¨    56  Ba  Î∞îÎ•®
5   ÏãùÌíàÏùò Ïò§Ïóº ÏßÄÌëú   Í≥†Í∏â  Î∞©ÏÇ¨Îä• ÏÇ¨Í≥† Ïãú Î∞©ÏÇ¨ÏÑ†ÏùÑ Í∞ÄÏû• ÎßéÏù¥ Î∞©Ï∂úÌïòÎäî ÏïÑÏù¥Ïò§ÎîòÍ≥º ÏÑ∏ÏäòÏùÑ ÏãùÌíà Ïò§Ïóº ÏßÄÌëúÎ°ú ÌôúÏö©Ìï©ÎãàÎã§.  53  I   ÏïÑÏù¥Ïò§Îîò    55  Cs  ÏÑ∏Ïäò
6   ÌÄ¥Î¶¨ Î∂ÄÎ∂ÄÏùò Ïó≠ÏÇ¨ ÎìúÎùºÎßà   Í≥†Í∏â  ÌÄ¥Î¶¨ Î∂ÄÎ∂ÄÍ∞Ä Î∞úÍ≤¨Ìïú Î∞©ÏÇ¨ÏÑ± ÏõêÏÜåÎì§ÏûÖÎãàÎã§. ÏúÑÌóòÌïú ÎìúÎùºÎßà Ï¥¨ÏòÅÏùÄ ÌîºÌï¥ÏïºÍ≤†Ï£†?  84  Po  Ìè¥Î°úÎäÑ 88  Ra  ÎùºÎìê
9   Ìïµ Ï†úÏñ¥Î¥â   Í≥†Í∏â  Ïó∞ÏáÑ ÌïµÎ∂ÑÏó¥ ÏÜçÎèÑÎ•º Ï°∞Ï†àÌï† Îïå ÏÇ¨Ïö©Îê©ÎãàÎã§. Ï§ëÏÑ±ÏûêÎ•º Ïûò Ìù°ÏàòÌïòÎäî ÏõêÏÜåÎì§Ïù¥Ï£†.  5   B   Î∂ïÏÜå  47  Ag  ÏùÄ   72  Hf  ÌïòÌîÑÎäÑ
7   Ïä§ÌÖåÏù∏Î¶¨Ïä§   Í≥†Í∏â  ÎÖπÏù¥ Í±∞Ïùò Ïä¨ÏßÄ ÏïäÎäî Ìï©Í∏àÏûÖÎãàÎã§. Îã§ÏñëÌïú Í∏àÏÜç Ï†úÌíàÏóê ÌôúÏö©Îê©ÎãàÎã§.  24  Cr  ÌÅ¨Î°úÎÆ¥ 26  Fe  Ï≤†   28  Ni  ÎãàÏºà
7   ÎåÄÌëúÏ†ÅÏù∏ ÏûêÏÑ± ÏõêÏÜå  Í≥†Í∏â  ÎÑ§Ïò§ÎîîÎÆ¥(Nd)ÎèÑ Ìè¨Ìï®Îê©ÎãàÎã§. ÏûêÏÑùÏùÑ Ï™ºÍ∞úÎ©¥ ÎòêÎã§Ïãú Îëê Í∑πÏù¥ ÏÉùÍ∏∞Ï£†. Ïù¥Î°†ÏÉÅ Î∂ÑÎ¶¨Îäî Î∂àÍ∞ÄÎä•Ìï©ÎãàÎã§.  26  Fe  Ï≤†   27  Co  ÏΩîÎ∞úÌä∏ 28  Ni  ÎãàÏºà
6   ÎèôÏ†Ñ  Í≥†Í∏â  Ïù∏Î•ò Ïó≠ÏÇ¨ÏÉÅ Í∞ÄÏû• Ï¢ãÏùÄ ÏπúÍµ¨Ïù¥Ï£†. Î∞úÌñâ ÎπÑÏö© ÎïåÎ¨∏Ïóê ÏßÄÌèêÎ°ú ÎÑòÏñ¥Í∞ÄÎäî Ï∂îÏÑ∏ÏûÖÎãàÎã§.  28  Ni  ÎãàÏºà  29  Cu  Íµ¨Î¶¨  30  Zn  ÏïÑÏó∞
7   Í∞àÎ¶∞Ïä§ÌÉÑ    Í≥†Í∏â  ÎèÖÏÑ±Ïù¥ Ï†ÅÏñ¥ ÏàòÏùÄ ÎåÄÏ≤¥Ï†úÎ°ú, ÎÉâÍ∞ÅÏû¨¬∑Ï≤¥Ïò®Í≥Ñ Ïû¨Î£åÎ°ú ÏÇ¨Ïö©Îê©ÎãàÎã§.  31  Ga  Í∞àÎ•®  49  In  Ïù∏Îìê  50  Sn  Ï£ºÏÑù
8   ÎèÖÏïΩ  Í≥†Í∏â  ÎåÄÌëúÏ†Å ÎßπÎèÖÏúºÎ°ú, Ïó≠ÏÇ¨Ï†ÅÏúºÎ°ú ÏïîÏÇ¥Ïóê ÎßéÏù¥ Ïù¥Ïö©ÎêòÏóàÏäµÎãàÎã§.  33  As  ÎπÑÏÜå  81  Tl  ÌÉàÎ•®  84  Po  Ìè¥Î°úÎäÑ
8   Î™©ÏÜåÎ¶¨Î•º Î≥ÄÌôîÏãúÌÇ§Îäî Í∏∞Ï≤¥   Í≥†Í∏â  ÎπÑÌôúÏÑ± Í∏∞Ï≤¥Î°ú Ìù°ÏûÖ Ïãú ÏßÑÎèôÏàòÎ•º Î∞îÍøî Î™©ÏÜåÎ¶¨Î•º ÎÜíÏù¥Í±∞ÎÇò ÎÇÆÏ∂•ÎãàÎã§.  2   He  Ìó¨Î•®  36  Kr  ÌÅ¨Î¶ΩÌÜ§ 54  Xe  Ï†úÎÖº
8   ÌååÎûÄÏÉâ ÌÅ¨Î†àÌååÏä§    Í≥†Í∏â  Ïù∏Îßù Î∏îÎ£®ÎùºÍ≥† Î∂àÎ¶¨Îäî ÌôîÌï©Î¨ºÏù¥ Îçî Í∞ïÌïú ÌååÎûÄÏÉâÏùÑ ÎÇòÌÉÄÎÇ¥ ÌÅ¨Î†àÌååÏä§Î°ú Ïù¥Ïö©Îê©ÎãàÎã§.  25  Mn  ÎßùÍ∞ÄÎãàÏ¶à    39  Y   Ïù¥Ìä∏Î•® 49  In  Ïù∏Îìê
8   Ï¥àÏ†ÑÎèÑ ÏûêÏÑù  Í≥†Í∏â  ÏïàÏ†ïÏ†Å ÏûêÍ∏∞Ïû•ÏùÑ ÏñªÏùÑ Ïàò ÏûàÍ≥†, ÏÜåÎ™®Ï†ÑÎ†•Ïù¥ Ï†ÅÏñ¥ ÎØ∏Îûò Í≥ºÌïôÍ∏∞Ïà†Ïùò ÌïµÏã¨ ÏÜåÏû¨ÏûÖÎãàÎã§.  22  Ti  Ìã∞ÌÉÄÎäÑ 41  Nb  ÎÇòÏù¥Ïò§Î∏Ä    50  Sn  Ï£ºÏÑù
9   Î∞©ÏÇ¨ÏÑ† ÏßÑÎã®  Í≥†Í∏â  Ïïî¬∑ÎÇúÏπòÏÑ± ÏßàÌôò ÏßÑÎã®ÏùÑ ÏúÑÌïú ÌïµÏùòÌïô ÏòÅÏÉÅÍ≤ÄÏÇ¨Ïóê ÏÇ¨Ïö©ÎêòÎäî Î∞©ÏÇ¨ÏÑ± ÏõêÏÜåÎì§ÏûÖÎãàÎã§.  43  Tc  ÌÖåÌÅ¨ÎÑ§Ìä¨    53  I   ÏïÑÏù¥Ïò§Îîò    83  Bi  ÎπÑÏä§Î¨¥Ìä∏
9   Î∞∞Í∏∞Í∞ÄÏä§ Ï†úÍ±∞ Ï¥âÎß§  Í≥†Í∏â  Î°úÎìêÏùÄ ÏßàÏÜåÏÇ∞ÌôîÎ¨º, ÌåîÎùºÎìêÍ≥º Î∞±Í∏àÏùÄ ÌÉÑÏÜåÌôîÌï©Î¨ºÏùÑ ÏïàÏ†ÑÌïú Î¨ºÏßàÎ°ú Ï†ÑÌôòÌï©ÎãàÎã§.  45  Rh  Î°úÎìê  46  Pd  ÌåîÎùºÎìê 78  Pt  Î∞±Í∏à
7   Í∑ÄÍ∏àÏÜç Í≥†Í∏â  Ïû•ÏãùÏö©¬∑Ìà¨ÏûêÏö©ÏúºÎ°ú Ìù¨Í∑ÄÌïòÎ©∞, ÏÇ∞ÌôîÍ∞Ä Í±∞Ïùò ÏùºÏñ¥ÎÇòÏßÄ ÏïäÎäî Í∏àÏÜçÎì§ÏûÖÎãàÎã§.  47  Ag  ÏùÄ   78  Pt  Î∞±Í∏à  79  Au  Í∏à
8   Îã¥Î∞∞Ïùò Ï§ëÍ∏àÏÜçÏùÑ ÏóÜÏï†Ï£ºÏÑ∏Ïöî  Í≥†Í∏â  Î∞±Ìï¥Î¨¥ÏùµÌïú Îã¥Î∞∞‚Ä¶ Ïù¥ÎûòÎèÑ ÌîºÏö¥Îã§Íµ¨Ïöî?  48  Cd  Ïπ¥ÎìúÎÆ¥ 80  Hg  ÏàòÏùÄ  82  Pb  ÎÇ©
8   ÌîåÎ£®Ïò§Î°úÏïàÌã∞Î™¨ÏÇ∞    Í≥†Í∏â  ÏßÄÍ∏àÍπåÏßÄ Î∞úÍ≤¨Îêú Î≥¥Í¥Ä Í∞ÄÎä•Ìïú ÌôîÌï©Î¨º Ï§ë Í∞ÄÏû• ÎÜíÏùÄ ÏÇ∞ÎèÑÎ•º Í∞ÄÏßÄÎ©∞ Í±∞Ïùò Î™®Îì† Ïú†Í∏∞ÌôîÌï©Î¨ºÏùÑ ÎÖπÏó¨Î≤ÑÎ¶ΩÎãàÎã§.  1   H   ÏàòÏÜå  9   F   ÌîåÎ£®Ïò§Î¶∞    51  Sb  ÏïàÌã∞Î™®Îãà
7   tert-Î∂ÄÌã∏Î¶¨Ìä¨   Í≥†Í∏â  ÏßÄÍ∏àÍπåÏßÄ Î∞úÍ≤¨Îêú ÌôîÌï©Î¨º Ï§ë Í∞ÄÏû• ÎÜíÏùÄ ÏóºÍ∏∞Î•º Í∞ÄÏßÄÎ©∞ Ïú†Í∏∞ÌôîÌï©Î¨ºÏùÑ ÎÖπÏó¨Î≤ÑÎ¶ΩÎãàÎã§.  1   H   ÏàòÏÜå  3   Li  Î¶¨Ìä¨  6   C   ÌÉÑÏÜå
9   Î∞òÍ∞êÍ∏∞Í∞Ä ÏßßÏùÄ ÏõêÏÜå  Í≥†Í∏â  Î∞òÍ∞êÍ∏∞Í∞Ä ÎÑàÎ¨¥ ÏßßÏïÑ ÏÉùÏÑ±ÎêòÏûêÎßàÏûê Î∂ïÍ¥¥Ìï¥Î≤ÑÎ¶¨Îäî ÏõêÏÜåÎì§ÏûÖÎãàÎã§.  75  Re  Î†àÎäÑ  85  At  ÏïÑÏä§ÌÉÄÌã¥    87  Fr  ÌîÑÎûëÏäò
8   ÏßÄÍµ¨Ïùò Íµ¨ÏÑ±ÏÑ±Î∂Ñ    Í≥†Í∏â  ÏßÄÍµ¨Î•º Íµ¨ÏÑ±ÌïòÎäî Ï£ºÏöî ÏõêÏÜåÎì§ÏûÖÎãàÎã§.  8   O   ÏÇ∞ÏÜå  12  Mg  ÎßàÍ∑∏ÎÑ§Ïäò    14  Si  Í∑úÏÜå  26  Fe  Ï≤†
9   ÏóîÏßÑÏùò Ìï©Í∏à  Í≥†Í∏â  Ïù¥Îì§Î°ú Ïù¥Î§ÑÏßÑ Ìï©Í∏àÏùÄ ÎÇ¥Ïó¥ÏÑ±Ïù¥ Îß§Ïö∞ ÎÜíÏïÑ ÏóîÏßÑÏö© Í∏àÏÜçÏúºÎ°ú ÌôúÏö©ÎêòÍ∏∞Ïóê Ï∂©Î∂ÑÌï©ÎãàÎã§.  23  V   Î∞îÎÇòÎìê 24  Cr  ÌÅ¨Î°úÎÆ¥ 26  Fe  Ï≤†   28  Ni  ÎãàÏºà
7   Ï†ÑÏÑ†  Í≥†Í∏â  Ï†ÑÍ∏∞Í∞Ä Ïûò ÌùêÎ•¥Îäî Ïù¥Îì§ ÏõêÏÜåÎäî Ï†ÑÏÑ†Ïóê ÌäπÌûà ÎßéÏù¥ Ïù¥Ïö©Îê©ÎãàÎã§.  13  Al  ÏïåÎ£®ÎØ∏ÎäÑ    29  Cu  Íµ¨Î¶¨  47  Ag  ÏùÄ   79  Au  Í∏à
8   Î∂ÑÏüÅÍ¥ëÎ¨ºÏùÑ Íµ¨Ìï¥Ï£ºÏÑ∏Ïöî Í≥†Í∏â  Î¨¥Ïû•ÏÑ∏Î†•Ïù¥ Ïù¥ Í¥ëÎ¨ºÏùò Ïú†ÌÜµÍ≥º Ï±ÑÍµ¥ÏùÑ Ïû•ÏïÖÌï¥ Ïù∏Í∂åÎ¨∏Ï†úÎ•º Î∞úÏÉùÏãúÌÇµÎãàÎã§.  50  Sn  Ï£ºÏÑù  73  Ta  ÌÉÑÌÉàÎüº 74  W   ÌÖÖÏä§ÌÖê 79  Au  Í∏à
9   ÎÇ¥Ïó¥ÏÑ±Ïù¥ ÎÜíÏùÄ ÏõêÏÜå  Í≥†Í∏â  ÎÇ¥Ïó¥ÏÑ±Ïù¥ Îß§Ïö∞ ÎÜíÏïÑ Í¥ÄÎ†® ÏÑ±ÏßàÏùÑ ÌïÑÏöîÎ°ú ÌïòÎäî ÏÇ∞ÏóÖÏóê ÏûêÏ£º Ïù¥Ïö©ÎêòÎäî ÏõêÏÜåÏûÖÎãàÎã§.  74  W   ÌÖÖÏä§ÌÖê 75  Re  Î†àÎäÑ  76  Os  Ïò§Ïä§ÎÆ¥ 77  Ir  Ïù¥Î¶¨Îìê
0   ÌïµÎ¨¥Í∏∞ Í≥†Í∏â  Ïù¥ Ïπ¥ÎìúÎäî Ï£ºÏÇ¨ÏúÑ Í∞í(89~103)Ïóê ÌÅêÎ∏åÍ∞Ä ÏûàÎã§Î©¥ ÏÉùÏÇ∞Ìï† Ïàò ÏûàÏäµÎãàÎã§.  92  U   Ïö∞ÎùºÎäÑ 94  Pu  ÌîåÎ£®ÌÜ†ÎäÑ
`;

// --- GLOBAL STATE & CONFIG ---
let gameState = {};
const playerColors = ['red', 'blue', 'green', 'yellow', 'purple', 'pink'];
const allDiceTypes = ['d4', 'd6', 'd8', 'd10', 'd12', 'd20', 'd%'];
const diceNames = {
    'd4': 'ÏÇ¨Î©¥Ï≤¥', 'd6': 'Ïú°Î©¥Ï≤¥', 'd8': 'ÌåîÎ©¥Ï≤¥', 'd10': 'Ïã≠Î©¥Ï≤¥',
    'd12': 'Ïã≠Ïù¥Î©¥Ï≤¥', 'd20': 'Ïù¥Ïã≠Î©¥Ï≤¥', 'd%': 'Î∞±Î∂ÑÏú®'
};
const technologies = {
    multiply: { id: 'multiply', name: 'Í≥±ÏÖà/ÎÇòÎàóÏÖà', icon: '‚ú∂', desc: "+, ‚Äì ÎåÄÏã† √ó ÎòêÎäî √∑ Ïó∞ÏÇ∞ÏùÑ ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏäµÎãàÎã§." },
    concat: { id: 'concat', name: 'ÏûêÎ¶¨Î∂ôÏù¥Í∏∞', icon: '‚ßñ', desc: "Îëê Ï£ºÏÇ¨ÏúÑ ÎààÏùÑ Ïù¥Ïñ¥ Î∂ôÏó¨ Îëê ÏûêÎ¶øÏàòÎ•º ÎßåÎì≠ÎãàÎã§." },
    slide: { id: 'slide', name: 'Ïä¨ÎùºÏù¥Îìú', icon: '‚Üî', desc: "ÌÅêÎ∏å Î∞∞Ïπò ÌõÑ, ÎÇ¥ ÌÅêÎ∏å Ï§ë 1Í∞úÎ•º Ïù∏Ï†ëÌïú(ÏûêÏã†Ïùò ÌÅêÎ∏åÍ∞Ä ÏóÜÎäî) Ïπ∏ÏúºÎ°ú Ïù¥ÎèôÏãúÌÇµÎãàÎã§." },
    outsource: { id: 'outsource', name: 'Ïô∏Ï£º ÏÉùÏÇ∞', icon: 'üÑß', desc: "Ïπ¥Îìú ÌåêÎß§ Ïãú, ÌïÑÏöî ÏõêÏÜå 1Í∞úÎ•º ÏÉÅÎåÄÎ∞© ÌÅêÎ∏åÎ°ú ÎåÄÏ≤¥Ìï©ÎãàÎã§. (ÎùºÏö¥ÎìúÎãπ 1Ìöå)" }
};
const diceRewards = [5, 10, 20, 40];
const techRewards = [10, 20, 30, 40];

// --- COORDINATE MAP FOR NEIGHBORS ---
const elementCoords = {};
const coordsToElement = {};
function buildCoordinateMap() {
    const mainGridMapping = {
        1: {r:1, c:1}, 2: {r:1, c:18}, 3: {r:2, c:1}, 4: {r:2, c:2},
        5: {r:2, c:13}, 6: {r:2, c:14}, 7: {r:2, c:15}, 8: {r:2, c:16}, 9: {r:2, c:17}, 10: {r:2, c:18},
        11: {r:3, c:1}, 12: {r:3, c:2}, 13: {r:3, c:13}, 14: {r:3, c:14}, 15: {r:3, c:15}, 16: {r:3, c:16}, 17: {r:3, c:17}, 18: {r:3, c:18},
    };
    for(const [num, pos] of Object.entries(mainGridMapping)) {
        elementCoords[num] = pos;
    }
    for(let i=19; i<=36; i++) elementCoords[i] = {r:4, c:i-18};
    for(let i=37; i<=54; i++) elementCoords[i] = {r:5, c:i-36};
    for(let i=55; i<=56; i++) elementCoords[i] = {r:6, c:i-54};
    for(let i=72; i<=86; i++) elementCoords[i] = {r:6, c:i-68};
    for(let i=87; i<=88; i++) elementCoords[i] = {r:7, c:i-86};
    for(let i=104; i<=118; i++) elementCoords[i] = {r:7, c:i-100};
    for(let i=57; i<=71; i++) elementCoords[i] = {r:8, c:i-54};
    for(let i=89; i<=103; i++) elementCoords[i] = {r:9, c:i-86};

    for(const [num, pos] of Object.entries(elementCoords)) {
        coordsToElement[`${pos.r},${pos.c}`] = parseInt(num);
    }
}


// DOM Elements
const app = {
    setupModal: document.getElementById('setup-modal'),
    startGameBtn: document.getElementById('start-game-btn'),
    playerCountSelector: document.getElementById('player-count-selector'),
    gameStatus: document.getElementById('game-status'),
    playersPanel: document.getElementById('players-panel'),
    tableContainer: document.getElementById('periodic-table-container'),
    controlsPanel: document.getElementById('controls-panel'),
    basicMarket: document.getElementById('basic-market'),
    advancedMarket: document.getElementById('advanced-market'),
    calcModal: document.getElementById('calculation-modal'),
    calcPlayerName: document.getElementById('calc-player-name'),
    diceRollResults: document.getElementById('dice-roll-results'),
    singleDiceOptions: document.getElementById('single-dice-options'),
    calcDice1: document.getElementById('calc-dice-1'),
    calcDice2: document.getElementById('calc-dice-2'),
    calcOp: document.getElementById('calc-op'),
    calcResult: document.getElementById('calc-result'),
    calcError: document.getElementById('calc-error'),
    confirmProductionBtn: document.getElementById('confirm-production-btn'),
    choiceModal: document.getElementById('choice-modal'),
    choiceTitle: document.getElementById('choice-title'),
    choiceOptions: document.getElementById('choice-options'),
    gameOverModal: document.getElementById('game-over-modal'),
    finalScores: document.getElementById('final-scores'),
    gameStats: document.getElementById('game-stats'),
    scoreboardPanel: document.getElementById('scoreboard-panel'),
    techTrackPanel: document.getElementById('tech-track-panel'),
    devPanel: document.getElementById('dev-panel'),
    toggleDevPanelBtn: document.getElementById('toggle-dev-panel'),
    returnToModalBtn: document.getElementById('return-to-modal-btn'),
};

// --- UTILITY FUNCTIONS ---
const shuffle = (array) => { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[array[i], array[j]] = [array[j], array[i]]; } return array; };
const rollDie = (type) => { if (type === 'd%') return Math.floor(Math.random() * 10) * 10; const sides = parseInt(type.slice(1)); return Math.floor(Math.random() * sides) + 1; };
const showMessage = (text, onOk) => {
    const modal = document.createElement('div');
    modal.className = 'modal-backdrop';
    modal.innerHTML = `
        <div class="modal-content text-center">
            <p class="text-lg mb-4 whitespace-pre-line">${text}</p>
            <button class="btn btn-primary">ÌôïÏù∏</button>
        </div>
    `;
    modal.querySelector('button').onclick = () => {
        document.body.removeChild(modal);
        if (onOk) onOk();
    };
    document.body.appendChild(modal);
};

// --- DATA PARSING ---
const parseCards = () => {
    const lines = cardDataString.trim().split('\n');
    return lines.map((line, index) => {
        // Split by 2 or more spaces, but also use a lookahead to handle single spaces before numbers
        const parts = line.split(/\s{2,}|(?=\s\d+\s)/).filter(p => p && p.trim());
        const score = parseInt(parts[0]);
        if (isNaN(score)) return null;
        const name = parts[1];
        const type = parts[2] === 'ÏùºÎ∞ò' ? 'basic' : 'advanced';
        const text = parts[3];
        const elementData = parts.slice(4);
        const elements = [];
        for (let i = 0; i < elementData.length; i += 3) {
            const num = parseInt(elementData[i]);
            if (!isNaN(num)) elements.push(num);
        }
        return { id: `card-${index}`, score, name, type, text, elements };
    }).filter(Boolean);
};
const allCards = parseCards();

// --- RENDER FUNCTIONS ---
function render() {
    if (!gameState.players) return;
    renderScoreboard();
    renderPlayersPanel();
    renderPeriodicTable();
    renderMarket();
    renderTechTrack();
    updateGameStatus();
    renderControls();
}

function renderScoreboard() {
    app.scoreboardPanel.innerHTML = '';
    const track = document.createElement('div');
    track.id = 'scoreboard-track';

    for (let i = 1; i <= 60; i++) {
        const cell = document.createElement('div');
        cell.className = 'score-cell';
        cell.textContent = i;
        cell.id = `score-cell-${i}`;
        if (diceRewards.includes(i)) cell.classList.add('dice-reward');
        if (techRewards.includes(i)) cell.classList.add('tech-reward');
        track.appendChild(cell);
    }
    app.scoreboardPanel.appendChild(track);

    const scorePositions = {};
    gameState.players.forEach(player => {
        const score = player.score > 60 ? 60 : player.score;
        if (!scorePositions[score]) {
            scorePositions[score] = 0;
        }
        const token = document.createElement('div');
        token.className = `player-token cube-${player.color}`;
        token.title = player.name;
        
        const targetCell = track.querySelector(`#score-cell-${score || 1}`);
        if (targetCell) {
            const offset = scorePositions[score] * 10;
            token.style.left = `${10 + offset}%`;
            token.style.top = `${10 + offset}%`;
            targetCell.appendChild(token);
            scorePositions[score]++;
        }
    });
}

function renderPlayersPanel() {
    app.playersPanel.innerHTML = '';
    gameState.players.forEach(player => {
        const playerDiv = document.createElement('div');
        playerDiv.className = `p-4 bg-bg-card border border-border-color rounded-lg shadow-md transition-all duration-300 ${player.id === gameState.currentPlayerId ? 'player-card active' : ''}`;
        
        const techHtml = player.tech.map(techId => {
            const tech = technologies[techId];
            return `<span class="tech-icon tech-${techId}" title="${tech.name}: ${tech.desc}">${tech.icon}</span>`;
        }).join('');

        const diceHtml = player.dice.map(d => `<span class="bg-slate-600 px-2 py-1 rounded text-xs font-mono">${diceNames[d]}</span>`).join(' ');
        
        let diceRollsHtml = '';
        if (gameState.phase === 'production' && player.diceResults.length > 0) {
            diceRollsHtml = `
                <div class="mt-2 p-2 bg-bg-dark rounded-md">
                    <p class="text-xs text-text-secondary mb-1">Ï£ºÏÇ¨ÏúÑ Í≤∞Í≥º:</p>
                    <div class="flex flex-wrap gap-1">
                        ${player.diceResults.map(r => `<span class="font-bold text-accent-cyan">${r.value}</span>`).join(', ')}
                    </div>
                </div>
            `;
        }

        playerDiv.innerHTML = `
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-xl font-bold flex items-center gap-2">
                    <span class="w-5 h-5 rounded-full cube-${player.color}"></span>
                    ${player.name}
                </h3>
            </div>
            <div class="space-y-3 text-sm">
                <p class="flex items-center gap-2"><strong>Ï£ºÏÇ¨ÏúÑ:</strong> <span class="flex flex-wrap gap-1">${diceHtml}</span></p>
                <p class="flex items-start gap-2"><strong>Í∏∞Ïà†:</strong> <span class="flex flex-wrap gap-1">${techHtml || 'ÏóÜÏùå'}</span></p>
                <p><strong>ÏÉùÏÇ∞ ÌÅêÎ∏å:</strong> <span class="font-bold text-accent-cyan">${player.cubesOnBoard.length} / 6</span></p>
            </div>
            ${diceRollsHtml}
        `;
        app.playersPanel.appendChild(playerDiv);
    });
}

function renderPeriodicTable() {
    const container = app.tableContainer;
    container.innerHTML = ''; // Clear previous content

    const mainGrid = document.createElement('div');
    mainGrid.className = 'periodic-table-grid';
    
    const lanthanideGrid = document.createElement('div');
    lanthanideGrid.className = 'periodic-table-grid mt-4';
    
    const actinideGrid = document.createElement('div');
    actinideGrid.className = 'periodic-table-grid mt-1';

    const productionTarget = gameState.productionTarget;

    for (let i = 1; i <= 118; i++) {
        const element = periodicTableData[i];
        if (!element) continue;

        const cell = document.createElement('div');
        cell.className = `element-cell group-${element.group}`;
        cell.dataset.atomicNumber = i;

        if (productionTarget === i) cell.classList.add('producible');
        if (gameState.explosionChoices?.includes(i) || gameState.slideChoices?.includes(i)) cell.classList.add('explosion-choice');
        if (gameState.slideSource === i) cell.classList.add('slide-source');

        const playersOnElement = gameState.players.filter(p => p.cubesOnBoard.includes(i));
        const cubeHtml = playersOnElement.map(p => `<div class="cube cube-${p.color}" title="${p.name}"></div>`).join('');

        cell.innerHTML = `
            <div class="element-number">${element.number}</div>
            <div class="element-symbol">${element.symbol}</div>
            <div class="element-name">${element.name}</div>
            <div class="cube-container">${cubeHtml}</div>
        `;

        if (element.number >= 57 && element.number <= 71) {
            cell.style.gridColumn = `${element.number - 57 + 3} / span 1`;
            lanthanideGrid.appendChild(cell);
        } else if (element.number >= 89 && element.number <= 103) {
            cell.style.gridColumn = `${element.number - 89 + 3} / span 1`;
            actinideGrid.appendChild(cell);
        } else {
            if (element.number === 1) cell.style.gridColumn = '1 / span 1';
            else if (element.number === 2) cell.style.gridColumn = '18 / span 1';
            else if (element.number >= 3 && element.number <= 4) cell.style.gridColumn = `${element.number - 2} / span 1`;
            else if (element.number >= 5 && element.number <= 10) cell.style.gridColumn = `${element.number + 8} / span 1`;
            else if (element.number >= 11 && element.number <= 12) cell.style.gridColumn = `${element.number - 10} / span 1`;
            else if (element.number >= 13 && element.number <= 18) cell.style.gridColumn = `${element.number} / span 1`;
            else if (element.number >= 19 && element.number <= 36) cell.style.gridColumn = `${element.number - 18} / span 1`;
            else if (element.number >= 37 && element.number <= 54) cell.style.gridColumn = `${element.number - 36} / span 1`;
            else if (element.number >= 55 && element.number <= 56) cell.style.gridColumn = `${element.number - 54} / span 1`;
            else if (element.number >= 72 && element.number <= 86) cell.style.gridColumn = `${element.number - 68} / span 1`;
            else if (element.number >= 87 && element.number <= 88) cell.style.gridColumn = `${element.number - 86} / span 1`;
            else if (element.number >= 104 && element.number <= 118) cell.style.gridColumn = `${element.number - 100} / span 1`;
            mainGrid.appendChild(cell);
        }
    }
    container.appendChild(mainGrid);
    container.appendChild(lanthanideGrid);
    container.appendChild(actinideGrid);
}

function renderMarket() {
    function renderDeck(market, deck, deckElem, deckType) {
        deckElem.innerHTML = '';
        market.forEach((card) => {
            deckElem.appendChild(createCardDOM(card, deckType, false));
        });
        
        const nextCard = deck[0];
        if (nextCard) {
            const previewWrapper = document.createElement('div');
            previewWrapper.className = "mt-3";
            previewWrapper.innerHTML = `<p class="text-xs text-center text-text-secondary mb-1">Îã§Ïùå Ïπ¥Îìú</p>`;
            previewWrapper.appendChild(createCardDOM(nextCard, deckType, true));
            deckElem.appendChild(previewWrapper);
        }
    }

    renderDeck(gameState.market.basic, gameState.decks.basic, app.basicMarket, 'basic');
    renderDeck(gameState.market.advanced, gameState.decks.advanced, app.advancedMarket, 'advanced');
    
    document.querySelectorAll('.sell-btn').forEach(btn => btn.addEventListener('click', handleSellCard));
}

function createCardDOM(card, cardType, isPreview) {
    const cardDiv = document.createElement('div');
    cardDiv.className = `bg-bg-card border border-border-color p-3 rounded-lg shadow-md flex flex-col ${isPreview ? 'opacity-50' : ''}`;
    
    const elementsHtml = card.elements.map(num => {
        const el = periodicTableData[num];
        const ownersHtml = gameState.players
            .filter(p => p.cubesOnBoard.includes(el.number))
            .map(p => `<div class="w-2 h-2 rounded-full cube-${p.color}" title="${p.name}"></div>`)
            .join('');

        return `<div class="flex items-center gap-1 bg-slate-700 px-2 py-1 rounded-full text-xs">
                   <div class="w-3 h-3 rounded-full" style="background-color: var(--group-${el.group})"></div>
                   <span class="font-bold">${el.symbol}</span>
                   <span class="text-text-secondary">(${el.number})</span>
                   <div class="flex ml-1 gap-px">${ownersHtml}</div>
                </div>`;
    }).join('');
    
    const canSell = canPlayerSellCard(gameState.players.find(p => p.id === gameState.currentPlayerId), card);

    cardDiv.innerHTML = `
        <div class="flex-grow">
            <div class="flex justify-between items-start">
                <h4 class="font-bold text-base ${card.type === 'basic' ? 'text-accent-amber' : 'text-fuchsia-400'}">${card.name}</h4>
                <span class="text-lg font-bold text-white">${card.score}Ï†ê</span>
            </div>
            <p class="text-xs text-text-secondary mt-1 mb-2">${card.text}</p>
            <div class="flex flex-wrap gap-2 items-center"><strong>ÌïÑÏöî:</strong> ${elementsHtml}</div>
        </div>
        <div class="text-right mt-3">
            <button class="btn text-sm sell-btn ${canSell && !isPreview ? 'btn-primary' : 'btn-secondary'}" 
                    data-card-id="${card.id}" data-card-type="${cardType}" ${(!canSell || isPreview || gameState.phase !== 'sales') ? 'disabled' : ''}>
                ÌåêÎß§
            </button>
        </div>
    `;
    return cardDiv;
}

function renderTechTrack() {
    app.techTrackPanel.innerHTML = '<h3 class="text-xl font-bold text-center mb-3 text-accent-cyan">üí° Í∏∞Ïà† Ìä∏Îûô</h3>';
    const grid = document.createElement('div');
    grid.className = 'grid grid-cols-2 gap-3';
    
    Object.values(technologies).forEach(tech => {
        const techCard = document.createElement('div');
        techCard.className = 'bg-bg-dark p-2 rounded';
        
        const acquiredByHtml = gameState.players
            .filter(p => p.tech.includes(tech.id))
            .map(p => `<div class="w-4 h-4 rounded-full cube-${p.color}" title="${p.name}"></div>`)
            .join('');

        techCard.innerHTML = `
            <div class="flex items-center gap-2">
                <span class="tech-icon tech-${tech.id}">${tech.icon}</span>
                <span class="font-bold">${tech.name}</span>
            </div>
            <p class="text-xs text-text-secondary mt-1">${tech.desc}</p>
            <div class="flex items-center gap-1 mt-2 h-4">${acquiredByHtml}</div>
        `;
        grid.appendChild(techCard);
    });
    app.techTrackPanel.appendChild(grid);
}

function renderControls() {
    app.controlsPanel.innerHTML = '';
    const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
    
    if (gameState.phase === 'production') {
        const text = document.createElement('p');
        text.className = 'text-text-secondary mb-2';
        text.textContent = `ÏÉùÏÇ∞ Îã®Í≥Ñ: ${player.name} ÎãòÏù¥ ÏÉùÏÇ∞Ìï† ÏõêÏÜåÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.`;
        app.controlsPanel.appendChild(text);

        const btn = document.createElement('button');
        btn.className = 'btn btn-primary';
        btn.textContent = 'ÏõêÏÜå ÏÑ†ÌÉùÌïòÍ∏∞';
        btn.onclick = () => openCalculationModal(player);
        app.controlsPanel.appendChild(btn);
        
    } else if (gameState.phase === 'sales') {
        const text = document.createElement('p');
        text.className = 'text-text-secondary mb-2';
        text.textContent = `ÌåêÎß§ Îã®Í≥Ñ: ${player.name} ÎãòÏùò Ï∞®Î°ÄÏûÖÎãàÎã§.`;
        app.controlsPanel.appendChild(text);

        const btn = document.createElement('button');
        btn.className = 'btn btn-secondary';
        btn.textContent = 'ÌåêÎß§ÌïòÏßÄ ÏïäÍ≥† ÌÑ¥ Ï¢ÖÎ£å';
        btn.onclick = handleEndTurn;
        app.controlsPanel.appendChild(btn);
    } else if (gameState.phase === 'AWAITING_SLIDE') {
        const text = document.createElement('p');
        text.className = 'text-text-secondary mb-2';
        text.textContent = `Ïä¨ÎùºÏù¥Îìú: Ïù¥ÎèôÌï† ÌÅêÎ∏åÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.`;
        app.controlsPanel.appendChild(text);
        const btn = document.createElement('button');
        btn.className = 'btn btn-secondary';
        btn.textContent = 'Ïä¨ÎùºÏù¥Îìú Í±¥ÎÑàÎõ∞Í∏∞';
        btn.onclick = () => {
            gameState.phase = 'production';
            advanceProductionTurn();
        };
        app.controlsPanel.appendChild(btn);
    }
}

function updateGameStatus() {
    if (!gameState.phase) return;
    const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
    let statusText = `ÎùºÏö¥Îìú ${gameState.round} | `;
    if (gameState.phase === 'production') {
        statusText += `ÏÉùÏÇ∞ Îã®Í≥Ñ - ${player.name} ÏÑ†ÌÉù Ï§ë`;
    } else if (gameState.phase === 'sales') {
        statusText += `ÌåêÎß§ Îã®Í≥Ñ - ${player.name}Ïùò ÌÑ¥`;
    } else if (gameState.phase === 'AWAITING_SLIDE') {
        statusText += `Ïä¨ÎùºÏù¥Îìú Îã®Í≥Ñ - ${player.name} ÌÅêÎ∏å Ïù¥Îèô Ï§ë`;
    }
    app.gameStatus.textContent = statusText;
}


// --- GAME LOGIC FUNCTIONS ---
function initGame() {
    const playerCount = gameState.playerCount;
    if (!playerCount) {
        showMessage('ÌîåÎ†àÏù¥Ïñ¥ ÏàòÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
        return;
    }
    app.setupModal.classList.add('hidden');

    const basicCards = allCards.filter(c => c.type === 'basic');
    const advancedCards = allCards.filter(c => c.type === 'advanced');
    const basicStarters = basicCards.filter(c => c.elements.length === 1);
    const basicOthers = basicCards.filter(c => c.elements.length !== 1);
    const advancedStarters = advancedCards.filter(c => c.elements.length === 1);
    const advancedOthers = advancedCards.filter(c => c.elements.length !== 1);

    gameState = {
        ...gameState,
        players: [],
        log: [],
        decks: {
            basic: [...basicStarters, ...shuffle(basicOthers)],
            advanced: [...advancedStarters, ...shuffle(advancedOthers)]
        },
        market: { basic: [], advanced: [] },
        round: 1,
        phase: 'production',
        currentPlayerId: 0,
        firstPlayerId: 0,
        gameOver: false,
        productionTarget: null,
        explosionChoices: null,
        slideSource: null,
        slideChoices: null,
        hiddenModal: null,
    };

    for (let i = 0; i < playerCount; i++) {
        gameState.players.push({
            id: i, name: `ÌîåÎ†àÏù¥Ïñ¥ ${i + 1}`, color: playerColors[i],
            score: 0, dice: ['d20', 'd6', 'd4'], tech: [],
            cubesOnBoard: [], soldCards: [],
            diceResults: [], usedOutsource: false,
            scoreMilestones: { dice: [], tech: [] }
        });
    }

    for (let i = 0; i < 4; i++) {
        if (gameState.decks.basic.length > 0) gameState.market.basic.push(gameState.decks.basic.shift());
        if (gameState.decks.advanced.length > 0) gameState.market.advanced.push(gameState.decks.advanced.shift());
    }

    startProductionPhase();
}

function logEvent(logData) {
    gameState.log.push({ ...logData, round: gameState.round });
}

function startProductionPhase() {
    gameState.phase = 'production';
    gameState.productionTarget = null;
    gameState.currentPlayerId = gameState.firstPlayerId;
    
    gameState.players.forEach(p => {
        p.diceResults = p.dice.map(d => ({ type: d, value: rollDie(d) }));
        p.usedOutsource = false;
    });
    showMessage("Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ï£ºÏÇ¨ÏúÑÎ•º Íµ¥Î†∏ÏäµÎãàÎã§! ÏÑ† ÌîåÎ†àÏù¥Ïñ¥Î∂ÄÌÑ∞ ÏõêÏÜåÎ•º ÏÉùÏÇ∞ÌïòÏÑ∏Ïöî.", render);
}

function openCalculationModal(player) {
    app.calcPlayerName.textContent = `${player.name}Ïùò ÏÉùÏÇ∞`;
    app.diceRollResults.innerHTML = player.diceResults.map(r => `<span class="bg-bg-dark border border-border-color p-2 rounded font-bold">${diceNames[r.type]}: ${r.value}</span>`).join('');
    
    app.singleDiceOptions.innerHTML = '';
    player.diceResults.forEach(r => {
        const btn = document.createElement('button');
        btn.className = 'btn btn-secondary';
        btn.textContent = r.value;
        btn.onclick = () => selectProductionNumber(r.value);
        app.singleDiceOptions.appendChild(btn);
    });

    const diceOptionsHtml = player.diceResults.map((r, i) => `<option value="${i}">${r.value} (${diceNames[r.type]})</option>`).join('');
    app.calcDice1.innerHTML = diceOptionsHtml;
    app.calcDice2.innerHTML = diceOptionsHtml;

    const ops = ['+', '‚àí'];
    if (player.tech.includes('multiply')) ops.push('√ó', '√∑');
    if (player.tech.includes('concat')) ops.push('‚ßñ');
    app.calcOp.innerHTML = ops.map(op => `<option value="${op}">${op}</option>`).join('');

    [app.calcDice1, app.calcDice2, app.calcOp].forEach(el => { el.onchange = updateCalcResult; });

    app.confirmProductionBtn.onclick = () => {
        const finalValue = parseInt(app.calcResult.textContent);
        if (isNaN(finalValue) || finalValue < 1 || finalValue > 118) {
            showMessage("Ïú†Ìö®Ìïú ÏõêÏûêÎ≤àÌò∏(1-118)Î•º ÎßåÎì§Ïñ¥Ï£ºÏÑ∏Ïöî.");
            return;
        }
        app.calcModal.classList.add('hidden');
        handlePlaceCube(player, finalValue);
    };
    
    updateCalcResult();
    app.calcModal.classList.remove('hidden');
}

function openChoiceModal({ title, options, onChoose, isDice = false }) {
    app.choiceTitle.textContent = title;
    app.choiceOptions.innerHTML = '';
    options.forEach(option => {
        const button = document.createElement('button');
        button.className = 'btn btn-secondary';
        button.textContent = isDice ? diceNames[option.text] : option.text;
        button.onclick = () => {
            app.choiceModal.classList.add('hidden');
            onChoose(option.value);
        };
        app.choiceOptions.appendChild(button);
    });
    app.choiceModal.classList.remove('hidden');
}


function selectProductionNumber(num) {
    app.calcResult.textContent = num;
    gameState.productionTarget = num;
    app.confirmProductionBtn.disabled = false;
    renderPeriodicTable();
}

function updateCalcResult() {
    const idx1 = parseInt(app.calcDice1.value);
    const idx2 = parseInt(app.calcDice2.value);
    const op = app.calcOp.value;
    
    const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
    if (!player) return;
    
    app.calcError.textContent = '';
    if (idx1 === idx2) {
        app.calcError.textContent = 'Ï§ëÎ≥µÎêú Ï£ºÏÇ¨ÏúÑÎ•º ÏÑ†ÌÉùÌï† Ïàò ÏóÜÏäµÎãàÎã§.';
        app.confirmProductionBtn.disabled = true;
        gameState.productionTarget = null;
        renderPeriodicTable();
        return;
    }

    const val1 = player.diceResults[idx1].value;
    const val2 = player.diceResults[idx2].value;

    let result = NaN;
    switch (op) {
        case '+': result = val1 + val2; break;
        case '‚àí': result = Math.abs(val1 - val2); break;
        case '√ó': result = val1 * val2; break;
        case '√∑': result = Math.floor(val1 / val2); break;
        case '‚ßñ': result = parseInt(`${val1}${val2}`); break;
    }
    
    if (isNaN(result) || result < 1 || result > 118) {
        app.calcResult.textContent = 'X';
        app.confirmProductionBtn.disabled = true;
        gameState.productionTarget = null;
    } else {
        app.calcResult.textContent = result;
        app.confirmProductionBtn.disabled = false;
        gameState.productionTarget = result;
    }
    renderPeriodicTable();
}

function handlePlaceCube(player, atomicNumber) {
    const isDuplicate = player.cubesOnBoard.includes(atomicNumber);

    if (isDuplicate) {
        showMessage("ÏõêÏÜå Ìè≠Î∞ú!", () => {
            const neighbors = getNeighbors(atomicNumber);
            const emptyNeighbors = neighbors.filter(n => !player.cubesOnBoard.includes(n));
            if (emptyNeighbors.length > 0) {
                gameState.explosionChoices = emptyNeighbors;
                renderPeriodicTable();
                showMessage("Ïù∏Ï†ëÌïú Îπà Ïπ∏ Ï§ë ÌïòÎÇòÎ•º ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅêÎ∏åÎ•º ÎÜìÏúºÏÑ∏Ïöî.");
            } else {
                showMessage("Ïù∏Ï†ëÌïú Îπà Ïπ∏Ïù¥ ÏóÜÏñ¥ ÌÅêÎ∏åÎ•º ÎÜìÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.", () => postPlacementAction(player));
            }
        });
    } else {
        if (player.cubesOnBoard.length >= 6) {
            openChoiceModal({
                title: 'ÌÅêÎ∏å ÍµêÏ≤¥: Ïñ¥Îäê ÌÅêÎ∏åÎ•º ÏòÆÍ∏∞ÏãúÍ≤†ÏäµÎãàÍπå?',
                options: player.cubesOnBoard.map(n => ({ text: `${periodicTableData[n].symbol} (${periodicTableData[n].name})`, value: n })),
                onChoose: (toRemove) => {
                    player.cubesOnBoard = player.cubesOnBoard.filter(n => n !== toRemove);
                    player.cubesOnBoard.push(atomicNumber);
                    logEvent({type: 'PRODUCE', player: player.name, element: periodicTableData[atomicNumber].name });
                    postPlacementAction(player);
                }
            });
        } else {
            player.cubesOnBoard.push(atomicNumber);
            logEvent({type: 'PRODUCE', player: player.name, element: periodicTableData[atomicNumber].name });
            postPlacementAction(player);
        }
    }
}

function postPlacementAction(player) {
    gameState.productionTarget = null;
    gameState.explosionChoices = null;
    render();
    if (player.tech.includes('slide')) {
        gameState.phase = 'AWAITING_SLIDE';
        showMessage(`${player.name}ÎãòÏùÄ Ïä¨ÎùºÏù¥Îìú Í∏∞Ïà†ÏùÑ ÏÇ¨Ïö©Ìï† Ïàò ÏûàÏäµÎãàÎã§. Ïù¥ÎèôÌï† ÌÅêÎ∏åÎ•º ÏÑ†ÌÉùÌïòÍ±∞ÎÇò Í±¥ÎÑàÎõ∞ÏÑ∏Ïöî.`);
        render();
    } else {
        advanceProductionTurn();
    }
}

function advanceProductionTurn() {
    gameState.productionTarget = null;
    gameState.explosionChoices = null;
    gameState.slideSource = null;
    gameState.slideChoices = null;
    gameState.phase = 'production';

    const nextPlayerId = (gameState.currentPlayerId + 1) % gameState.players.length;
    gameState.currentPlayerId = nextPlayerId;

    if (gameState.currentPlayerId === gameState.firstPlayerId) {
        startSalesPhase();
    } else {
        render();
    }
}

function getNeighbors(atomicNumber) {
    if (!elementCoords[atomicNumber]) return [];
    const { r, c } = elementCoords[atomicNumber];
    const potentialNeighbors = [
        coordsToElement[`${r},${c - 1}`], // left
        coordsToElement[`${r},${c + 1}`], // right
        coordsToElement[`${r - 1},${c}`], // up
        coordsToElement[`${r + 1},${c}`], // down
    ];
    // Special adjacency rules
    if (atomicNumber === 1) potentialNeighbors.push(2);
    if (atomicNumber === 2) potentialNeighbors.push(1);
    if (atomicNumber === 4) potentialNeighbors.push(5);
    if (atomicNumber === 5) potentialNeighbors.push(4);
    if (atomicNumber === 12) potentialNeighbors.push(13);
    if (atomicNumber === 13) potentialNeighbors.push(12);
    
    return [...new Set(potentialNeighbors.filter(n => n !== undefined))];
}

function startSalesPhase() {
    gameState.phase = 'sales';
    gameState.currentPlayerId = gameState.firstPlayerId;
    showMessage("ÏÉùÏÇ∞ Îã®Í≥ÑÍ∞Ä ÎÅùÎÇ¨ÏäµÎãàÎã§. Ïù¥Ï†ú ÌôîÌï©Î¨ºÏùÑ ÌåêÎß§ÌïòÏÑ∏Ïöî.", render);
}

function canPlayerSellCard(player, card) {
    if (!player || !card) return false;
    
    let ownedElements = 0;
    card.elements.forEach(elNum => {
        if (player.cubesOnBoard.includes(elNum)) {
            ownedElements++;
        }
    });

    if (ownedElements === card.elements.length) return true;

    if (player.tech.includes('outsource') && !player.usedOutsource) {
        let needed = [];
        card.elements.forEach(elNum => {
            if (!player.cubesOnBoard.includes(elNum)) needed.push(elNum);
        });
        if (needed.length === 1 && gameState.players.some(p => p.id !== player.id && p.cubesOnBoard.includes(needed[0]))) {
            return true;
        }
    }
    return false;
}

async function handleSellCard(event) {
    const cardId = event.target.dataset.cardId;
    const cardType = event.target.dataset.cardType;
    const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
    
    const market = gameState.market[cardType];
    const cardIndex = market.findIndex(c => c.id === cardId);
    if (cardIndex === -1) return;
    const card = market[cardIndex];

    if (canPlayerSellCard(player, card)) {
        const ownedCount = card.elements.filter(el => player.cubesOnBoard.includes(el)).length;
        if (ownedCount < card.elements.length) {
            player.usedOutsource = true;
        }

        const oldScore = player.score;
        player.score += card.score;
        player.soldCards.push(card);
        logEvent({type: 'SELL_CARD', player: player.name, cardName: card.name, score: card.score });


        market.splice(cardIndex, 1);
        const deck = gameState.decks[cardType];
        if (deck.length > 0) market.push(deck.shift());

        await showMessageAndWait(`${player.name}ÎãòÏù¥ '${card.name}' Ïπ¥ÎìúÎ•º ÌåêÎß§ÌïòÏó¨ ${card.score}Ï†êÏùÑ ÌöçÎìùÌñàÏäµÎãàÎã§! (Ï¥ù ${player.score}Ï†ê)`);
        
        await checkScoreMilestones(player, oldScore);
        
        if (gameState.gameOver) return;
        handleEndTurn();
    }
}

async function checkScoreMilestones(player, oldScore) {
    for (const score of diceRewards) {
        if (oldScore < score && player.score >= score && !player.scoreMilestones.dice.includes(score)) {
            player.scoreMilestones.dice.push(score);
            if (player.dice.length < 7) {
                const availableDice = allDiceTypes.filter(d => !player.dice.includes(d));
                if (availableDice.length > 0) {
                    const chosenDie = await new Promise(resolve => {
                        openChoiceModal({
                            title: `Ï£ºÏÇ¨ÏúÑ ÌöçÎìù! ÏõêÌïòÎäî Ï£ºÏÇ¨ÏúÑÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.`,
                            options: availableDice.map(d => ({ text: d, value: d })),
                            isDice: true,
                            onChoose: resolve
                        });
                    });
                    player.dice.push(chosenDie);
                    logEvent({type: 'GET_DICE', player: player.name, die: diceNames[chosenDie] });
                    await showMessageAndWait(`${player.name}ÎãòÏù¥ ${score}Ï†ê Î≥¥ÏÉÅÏúºÎ°ú ${diceNames[chosenDie]} Ï£ºÏÇ¨ÏúÑÎ•º ÌöçÎìùÌñàÏäµÎãàÎã§!`);
                }
            }
        }
    }

    for (const score of techRewards) {
        if (oldScore < score && player.score >= score && !player.scoreMilestones.tech.includes(score)) {
            player.scoreMilestones.tech.push(score);
            const availableTech = Object.values(technologies).filter(t => !player.tech.includes(t.id));
            if (availableTech.length > 0) {
                 const chosenTechId = await new Promise(resolve => {
                        openChoiceModal({
                            title: `Í∏∞Ïà† ÌöçÎìù! ÏõêÌïòÎäî Í∏∞Ïà†ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.`,
                            options: availableTech.map(t => ({ text: t.name, value: t.id })),
                            onChoose: resolve
                        });
                    });
                player.tech.push(chosenTechId);
                logEvent({type: 'GET_TECH', player: player.name, tech: technologies[chosenTechId].name });
                await showMessageAndWait(`${player.name}ÎãòÏù¥ ${score}Ï†ê Î≥¥ÏÉÅÏúºÎ°ú '${technologies[chosenTechId].name}' Í∏∞Ïà†ÏùÑ ÌöçÎìùÌñàÏäµÎãàÎã§!`);
            }
        }
    }

    if (player.score >= 50 && !gameState.isEnding) {
        gameState.isEnding = true;
        await showMessageAndWait(`Ïù¥Î≤à ÎùºÏö¥ÎìúÍ∞Ä ÎßàÏßÄÎßâ ÎùºÏö¥ÎìúÏûÖÎãàÎã§! ${player.name}ÎãòÏù¥ 50Ï†êÏùÑ ÎèåÌååÌñàÏäµÎãàÎã§!`);
    }
}

function showMessageAndWait(text) {
    return new Promise(resolve => showMessage(text, resolve));
}

function handleEndTurn() {
    if (gameState.gameOver) return;

    let nextPlayerId = (gameState.currentPlayerId + 1) % gameState.players.length;
    gameState.currentPlayerId = nextPlayerId;

    if (gameState.currentPlayerId === gameState.firstPlayerId) {
        if (gameState.isEnding) {
            endGame();
        } else {
            gameState.round++;
            gameState.firstPlayerId = (gameState.firstPlayerId + 1) % gameState.players.length;
            startProductionPhase();
        }
    } else {
        render();
    }
}

function endGame() {
    gameState.gameOver = true;

    const relevantGroups = new Set(['alkali-metal', 'transition-metal', 'metalloid', 'halogen', 'alkaline-earth-metal', 'post-transition-metal', 'other-nonmetal', 'noble-gas']);
    gameState.players.forEach(player => {
        const collectedGroups = new Set();
        player.soldCards.forEach(card => {
            card.elements.forEach(elNum => {
                const group = periodicTableData[elNum]?.group;
                if (relevantGroups.has(group)) {
                    collectedGroups.add(group);
                }
            });
        });
        player.elementColorCount = collectedGroups.size;
        player.finalScore = player.score + player.elementColorCount;
    });

    gameState.players.sort((a, b) => {
        if (b.finalScore !== a.finalScore) return b.finalScore - a.finalScore;
        const advancedCountB = b.soldCards.filter(c => c.type === 'advanced').length;
        const advancedCountA = a.soldCards.filter(c => c.type === 'advanced').length;
        if (advancedCountB !== advancedCountA) return advancedCountB - advancedCountA;
        if (b.elementColorCount !== a.elementColorCount) return b.elementColorCount - a.elementColorCount;
        return b.dice.length - a.dice.length;
    });

    app.finalScores.innerHTML = gameState.players.map((p, index) => `
        <div class="p-3 rounded ${index === 0 ? 'bg-accent-amber text-bg-dark' : 'bg-bg-dark text-text-primary'}">
            <p class="text-xl font-bold">${index + 1}ÏúÑ: ${p.name} - ${p.finalScore}Ï†ê</p>
            <p class="text-sm">Ïπ¥Îìú Ï†êÏàò ${p.score}Ï†ê + ÏõêÏÜå Ï¢ÖÎ•ò Î≥¥ÎÑàÏä§ ${p.elementColorCount}Ï†ê</p>
        </div>
    `).join('');

    displayGameStats();
    app.gameOverModal.classList.remove('hidden');
}

function displayGameStats() {
    let statsHtml = `<h3 class="text-lg font-bold mb-2 text-accent-cyan">Í≤åÏûÑ ÌÜµÍ≥Ñ</h3>`;
    const productionCounts = gameState.log.filter(l => l.type === 'PRODUCE').reduce((acc, l) => {
        acc[l.element] = (acc[l.element] || 0) + 1;
        return acc;
    }, {});
    const mostProduced = Object.entries(productionCounts).sort((a, b) => b[1] - a[1])[0];
    if (mostProduced) {
        statsHtml += `<p><strong>Í∞ÄÏû• ÎßéÏù¥ ÏÉùÏÇ∞Îêú ÏõêÏÜå:</strong> ${mostProduced[0]} (${mostProduced[1]}Ìöå)</p>`;
    }
    
    const sales = gameState.log.filter(l => l.type === 'SELL_CARD');
    const bestSale = sales.sort((a, b) => b.score - a.score)[0];
    if(bestSale) {
        statsHtml += `<p><strong>ÏµúÍ≥†Ï†ê Ïπ¥Îìú ÌåêÎß§:</strong> ${bestSale.player} (${bestSale.cardName}, ${bestSale.score}Ï†ê)</p>`;
    }
    app.gameStats.innerHTML = statsHtml;
}


// --- INITIALIZATION ---
function setupInitialUI() {
    buildCoordinateMap();
    for (let i = 2; i <= 6; i++) {
        const button = document.createElement('button');
        button.className = 'btn btn-secondary';
        button.textContent = `${i}Î™Ö`;
        button.dataset.count = i;
        app.playerCountSelector.appendChild(button);
    }

    app.playerCountSelector.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            const count = e.target.dataset.count;
            gameState.playerCount = parseInt(count);
            
            app.playerCountSelector.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('btn-primary', 'bg-accent-cyan');
                btn.classList.add('btn-secondary');
            });
            e.target.classList.remove('btn-secondary');
            e.target.classList.add('btn-primary', 'bg-accent-cyan');

            app.startGameBtn.disabled = false;
        }
    });

    app.startGameBtn.addEventListener('click', initGame);

    // Dev Tools
    app.toggleDevPanelBtn.addEventListener('click', () => {
        app.devPanel.classList.toggle('hidden');
    });

    document.getElementById('dev-add-score').addEventListener('click', () => {
        const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
        const scoreInput = document.getElementById('dev-score-num');
        const scoreToAdd = parseInt(scoreInput.value) || 0;
        if (player) {
            const oldScore = player.score;
            player.score += scoreToAdd;
            checkScoreMilestones(player, oldScore);
            render();
        }
    });

    document.getElementById('dev-add-die').addEventListener('click', () => {
        const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
        if (player && player.dice.length < 7) {
            const availableDice = allDiceTypes.filter(d => !player.dice.includes(d));
            if (availableDice.length > 0) {
                player.dice.push(availableDice[0]);
                render();
            }
        }
    });

    document.getElementById('dev-add-tech').addEventListener('click', () => {
        const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
        if (player) {
            const availableTech = Object.values(technologies).filter(t => !player.tech.includes(t.id));
            if (availableTech.length > 0) {
                player.tech.push(availableTech[0].id);
                render();
            }
        }
    });
    
    document.getElementById('dev-add-cube').addEventListener('click', () => {
        const player = gameState.players.find(p => p.id === gameState.currentPlayerId);
        const numInput = document.getElementById('dev-element-num');
        const num = parseInt(numInput.value);
        if (player && num > 0 && num <= 118) {
            if (!player.cubesOnBoard.includes(num)) {
                if (player.cubesOnBoard.length >= 6) {
                    player.cubesOnBoard.shift(); 
                }
                player.cubesOnBoard.push(num);
                numInput.value = ''; 
                render();
            }
        }
    });

    app.tableContainer.addEventListener('click', (e) => {
        const cell = e.target.closest('.element-cell');
        if (!cell) return;
        const num = parseInt(cell.dataset.atomicNumber);
        const player = gameState.players.find(p => p.id === gameState.currentPlayerId);

        if (gameState.explosionChoices?.includes(num)) {
            if (player.cubesOnBoard.length >= 6) {
                openChoiceModal({
                    title: 'ÌÅêÎ∏å ÍµêÏ≤¥: Ïñ¥Îäê ÌÅêÎ∏åÎ•º ÏòÆÍ∏∞ÏãúÍ≤†ÏäµÎãàÍπå?',
                    options: player.cubesOnBoard.map(n => ({ text: `${periodicTableData[n].symbol} (${periodicTableData[n].name})`, value: n })),
                    onChoose: (toRemove) => {
                        player.cubesOnBoard = player.cubesOnBoard.filter(n => n !== toRemove);
                        player.cubesOnBoard.push(num);
                        postPlacementAction(player);
                    }
                });
            } else {
                player.cubesOnBoard.push(num);
                postPlacementAction(player);
            }
        } else if (gameState.phase === 'AWAITING_SLIDE') {
            if (gameState.slideSource === null && player.cubesOnBoard.includes(num)) {
                gameState.slideSource = num;
                const neighbors = getNeighbors(num);
                gameState.slideChoices = neighbors.filter(n => !player.cubesOnBoard.includes(n));
                render();
            } else if (gameState.slideChoices?.includes(num)) {
                player.cubesOnBoard = player.cubesOnBoard.filter(n => n !== gameState.slideSource);
                player.cubesOnBoard.push(num);
                gameState.phase = 'production';
                advanceProductionTurn();
            }
        }
    });
    
    function hideCurrentModal(modalId) {
        gameState.hiddenModalId = modalId;
        document.getElementById(modalId).classList.add('hidden');
        app.returnToModalBtn.classList.remove('hidden');
    }
    
    function showHiddenModal() {
        if(gameState.hiddenModalId) {
            document.getElementById(gameState.hiddenModalId).classList.remove('hidden');
            app.returnToModalBtn.classList.add('hidden');
            gameState.hiddenModalId = null;
        }
    }
    
    document.getElementById('view-market-calc-btn').addEventListener('click', () => hideCurrentModal('calculation-modal'));
    document.getElementById('view-market-choice-btn').addEventListener('click', () => hideCurrentModal('choice-modal'));
    app.returnToModalBtn.addEventListener('click', showHiddenModal);
}

window.onload = () => {
    setupInitialUI();
    app.setupModal.classList.remove('hidden');
};
</script>

</body>
</html>
